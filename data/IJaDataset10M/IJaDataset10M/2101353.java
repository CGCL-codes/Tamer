package org.formaria.editor.netbeans.newproject;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import org.formaria.editor.netbeans.project.ProjectPanel;
import org.formaria.editor.project.EditorProject;
import javax.swing.JButton;
import javax.swing.BorderFactory;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import javax.swing.DefaultListSelectionModel;

/**
 * A single panel descriptor for a wizard.
 * You probably want to make a wizard iterator to hold it.
 *
 * Copyright (c) Formaria Ltd., 2005
 * $Revision: 1.2 $
 * License: see license.txt
 */
public class ExtraPropertiesPanel extends javax.swing.JPanel implements ActionListener, ListSelectionListener {

    private EditorProject currentProject;

    private ProjectPanel projectPanel;

    private JButton addBtn, removeBtn, refreshBtn;

    private ExtraPropertiesTableModel tableModel;

    /** Creates new form ExtraPropertiesPanel */
    public ExtraPropertiesPanel(EditorProject project, ProjectPanel pp) {
        currentProject = project;
        projectPanel = pp;
        initComponents();
    }

    /** This method is called from within the constructor to
   * initialize the form.
   * WARNING: Do NOT modify this code. The content of this method is
   * always regenerated by the Form Editor.
   */
    private void initComponents() {
        jLabel1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        otherPropsTable = new javax.swing.JTable();
        otherPropsTable.setBorder(BorderFactory.createEmptyBorder(1, 1, 1, 1));
        setLayout(null);
        jLabel1.setText("Properties");
        add(jLabel1);
        jLabel1.setBounds(10, 10, 70, 14);
        otherPropsTable.setBorder(new javax.swing.border.EtchedBorder());
        otherPropsTable.setModel(tableModel = new ExtraPropertiesTableModel(projectPanel, currentProject.getManagerObjects()));
        jScrollPane1.setViewportView(otherPropsTable);
        add(jScrollPane1);
        jScrollPane1.setBounds(130, 15, 360, 230);
        otherPropsTable.getSelectionModel().addListSelectionListener(this);
        refreshBtn = new JButton("Refresh");
        refreshBtn.setBounds(170, 255, 100, 20);
        addBtn = new JButton("Add...");
        addBtn.setBounds(390, 255, 100, 20);
        removeBtn = new JButton("Remove");
        removeBtn.setBounds(280, 255, 100, 20);
        refreshBtn.addActionListener(this);
        addBtn.addActionListener(this);
        removeBtn.addActionListener(this);
        add(refreshBtn);
        add(addBtn);
        add(removeBtn);
        addBtn.setEnabled(false);
        removeBtn.setEnabled(false);
    }

    public void actionPerformed(ActionEvent e) {
        if (e.getSource() == addBtn) {
            tableModel.addNewRow();
            addBtn.setEnabled(false);
        } else if (e.getSource() == removeBtn) {
            tableModel.removeRow(otherPropsTable.getSelectedRow());
            removeBtn.setEnabled(false);
        } else if (e.getSource() == refreshBtn) {
            otherPropsTable.setModel(tableModel = new ExtraPropertiesTableModel(projectPanel, currentProject.getManagerObjects()));
        }
    }

    public void valueChanged(ListSelectionEvent e) {
        DefaultListSelectionModel mdl = (DefaultListSelectionModel) e.getSource();
        int idx = mdl.getAnchorSelectionIndex();
        removeBtn.setEnabled(((idx < (tableModel.getRowCount() - 1)) && (idx >= 0)));
        addBtn.setEnabled(idx == (tableModel.getRowCount() - 1));
    }

    private javax.swing.JLabel jLabel1;

    private javax.swing.JScrollPane jScrollPane1;

    public javax.swing.JTable otherPropsTable;
}
