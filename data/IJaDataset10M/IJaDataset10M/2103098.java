package org.meowers.cide.edcide.tile;

import org.meowers.cide.edcide.*;
import javax.swing.*;
import org.meowers.cide.data.*;
import java.awt.*;
import java.awt.image.*;

/**
 *
 * @author  adam
 */
public class TileEditor extends EdCideEditor {

    private Tile t;

    private GameData gd;

    private EdCideTreeNode tileNode;

    private BufferedImage tileImage = null;

    /** Creates new form tileEditorPanel */
    public TileEditor() {
        initComponents();
    }

    public TileEditor(GameData gd, EdCideTreeNode tileNode) {
        initComponents();
        this.gd = gd;
        this.tileNode = tileNode;
        t = (Tile) tileNode.getGameObject();
        nameTextField.setText(t.getName());
        int tileSize = gd.getTileSize();
        tileSizeTextField.setText(tileSize + "x" + tileSize);
        tileImage = t.getImage();
        if (tileImage != null) {
            imagePreviewLabel.setIcon(new ImageIcon(tileImage));
            imagePreviewLabel.revalidate();
        }
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {
        generalPanel = new javax.swing.JPanel();
        nameLabel = new javax.swing.JLabel();
        nameTextField = new javax.swing.JTextField();
        tileSizeLabel = new javax.swing.JLabel();
        tileSizeTextField = new javax.swing.JTextField();
        imagePanel = new javax.swing.JPanel();
        imagePreviewLabel = new javax.swing.JLabel();
        imageEditButton = new javax.swing.JButton();
        setLayout(new java.awt.GridLayout(0, 1));
        generalPanel.setBorder(new javax.swing.border.TitledBorder("General"));
        nameLabel.setText("Name");
        generalPanel.add(nameLabel);
        nameTextField.setPreferredSize(new java.awt.Dimension(150, 17));
        nameTextField.setMinimumSize(new java.awt.Dimension(100, 17));
        generalPanel.add(nameTextField);
        tileSizeLabel.setText("Tile Size");
        generalPanel.add(tileSizeLabel);
        tileSizeTextField.setEditable(false);
        tileSizeTextField.setPreferredSize(new java.awt.Dimension(45, 19));
        generalPanel.add(tileSizeTextField);
        add(generalPanel);
        imagePanel.setLayout(new java.awt.BorderLayout());
        imagePanel.setBorder(new javax.swing.border.TitledBorder("Image"));
        imagePreviewLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        imagePanel.add(imagePreviewLabel, java.awt.BorderLayout.CENTER);
        imageEditButton.setText("Change...");
        imageEditButton.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                imageEditButtonActionPerformed(evt);
            }
        });
        imagePanel.add(imageEditButton, java.awt.BorderLayout.SOUTH);
        add(imagePanel);
    }

    private void imageEditButtonActionPerformed(java.awt.event.ActionEvent evt) {
        int tileSize = gd.getTileSize();
        TileImageEditorDialog d = new TileImageEditorDialog((JFrame) this.getTopLevelAncestor(), true, tileSize);
        d.show();
        tileImage = d.getImage();
        if (tileImage != null) {
            imagePreviewLabel.setIcon(new ImageIcon(tileImage));
            imagePreviewLabel.revalidate();
        }
    }

    public boolean apply() {
        t.setName(nameTextField.getText());
        tileNode.updateText();
        return true;
    }

    public void revert() {
    }

    private javax.swing.JPanel generalPanel;

    private javax.swing.JLabel nameLabel;

    private javax.swing.JTextField nameTextField;

    private javax.swing.JLabel tileSizeLabel;

    private javax.swing.JTextField tileSizeTextField;

    private javax.swing.JPanel imagePanel;

    private javax.swing.JLabel imagePreviewLabel;

    private javax.swing.JButton imageEditButton;
}
