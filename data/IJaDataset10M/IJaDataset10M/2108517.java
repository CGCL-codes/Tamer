package com.augcampos.gui;

import com.augcampos.core.n501070324_Pessoas;
import com.augcampos.core.n501070324_Tecnico;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

/**
 *
 ** @author Augusto Campos <b>augcampos@augcampos.pt</b>
 */
public class n501070324_TecnicsForm extends javax.swing.JInternalFrame {

    private n501070324_Pessoas pesoasLnk;

    /** Creates new form UserForm
     * @param ps
     */
    public n501070324_TecnicsForm(n501070324_Pessoas ps) {
        this.pesoasLnk = ps;
        initComponents();
        tblList.addMouseListener(new MouseAdapter() {

            @Override
            public void mouseClicked(MouseEvent e) {
                if (e.getClickCount() == 2) {
                    editData();
                }
            }
        });
        tblList.getSelectionModel().addListSelectionListener(new ListSelectionListener() {

            public void valueChanged(ListSelectionEvent e) {
                refreshDetails(getSelect());
            }
        });
        refreshData();
        refreshDetails(getSelect());
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;
        tbActions = new javax.swing.JToolBar();
        btAdd = new javax.swing.JButton();
        btEdit = new javax.swing.JButton();
        jSeparator1 = new javax.swing.JToolBar.Separator();
        btDelete = new javax.swing.JButton();
        tabsMain = new javax.swing.JTabbedPane();
        pnList = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblList = new javax.swing.JTable();
        pnDetails = new javax.swing.JPanel();
        lblNumero = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        txtNome = new javax.swing.JTextField();
        btSave = new javax.swing.JButton();
        btCancel = new javax.swing.JButton();
        setClosable(true);
        setTitle("Tecnicos");
        setMaximumSize(new java.awt.Dimension(404, 171));
        setMinimumSize(new java.awt.Dimension(404, 171));
        getContentPane().setLayout(new java.awt.GridBagLayout());
        tbActions.setFloatable(false);
        tbActions.setRollover(true);
        tbActions.setFocusable(false);
        tbActions.setMinimumSize(new java.awt.Dimension(50, 50));
        tbActions.setPreferredSize(new java.awt.Dimension(25, 25));
        btAdd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/augcampos/gui/webdev-add-48x48.png")));
        btAdd.setText("Adicionar");
        btAdd.setToolTipText("");
        btAdd.setFocusable(false);
        btAdd.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btAdd.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btAddActionPerformed(evt);
            }
        });
        tbActions.add(btAdd);
        btEdit.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/augcampos/gui/webdev-config-48x48.png")));
        btEdit.setText("Editar");
        btEdit.setToolTipText("");
        btEdit.setFocusable(false);
        btEdit.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btEdit.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btEditActionPerformed(evt);
            }
        });
        tbActions.add(btEdit);
        tbActions.add(jSeparator1);
        btDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/augcampos/gui/webdev-remove-48x48.png")));
        btDelete.setText("Apagar");
        btDelete.setToolTipText("");
        btDelete.setFocusable(false);
        btDelete.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btDelete.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btDeleteActionPerformed(evt);
            }
        });
        tbActions.add(btDelete);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 100.0;
        getContentPane().add(tbActions, gridBagConstraints);
        pnList.setLayout(new java.awt.GridBagLayout());
        tblList.setModel(new javax.swing.table.DefaultTableModel(new Object[][] {}, new String[] { "Nr", "Nome" }) {

            Class[] types = new Class[] { java.lang.Integer.class, java.lang.String.class };

            boolean[] canEdit = new boolean[] { false, false };

            public Class getColumnClass(int columnIndex) {
                return types[columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit[columnIndex];
            }
        });
        tblList.setColumnSelectionAllowed(true);
        tblList.setDoubleBuffered(true);
        tblList.setOpaque(false);
        tblList.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jScrollPane1.setViewportView(tblList);
        tblList.getColumnModel().getSelectionModel().setSelectionMode(javax.swing.ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        tblList.getColumnModel().getColumn(0).setResizable(false);
        tblList.getColumnModel().getColumn(0).setPreferredWidth(10);
        tblList.getColumnModel().getColumn(1).setResizable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 100.0;
        gridBagConstraints.weighty = 100.0;
        pnList.add(jScrollPane1, gridBagConstraints);
        tabsMain.addTab("Listagem", pnList);
        lblNumero.setText("0");
        jLabel1.setText("Numero :");
        jLabel3.setText("Nome ;");
        btSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/augcampos/gui/webdev-ok-48x48.png")));
        btSave.setText("Gravar");
        btSave.setMaximumSize(new java.awt.Dimension(100, 50));
        btSave.setMinimumSize(new java.awt.Dimension(100, 50));
        btSave.setPreferredSize(new java.awt.Dimension(150, 50));
        btSave.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btSaveActionPerformed(evt);
            }
        });
        btCancel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/augcampos/gui/webdev-cancel-48x48.png")));
        btCancel.setText("Cancelar");
        btCancel.setMaximumSize(new java.awt.Dimension(100, 26));
        btCancel.setMinimumSize(new java.awt.Dimension(100, 26));
        btCancel.setPreferredSize(new java.awt.Dimension(150, 50));
        btCancel.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btCancelActionPerformed(evt);
            }
        });
        javax.swing.GroupLayout pnDetailsLayout = new javax.swing.GroupLayout(pnDetails);
        pnDetails.setLayout(pnDetailsLayout);
        pnDetailsLayout.setHorizontalGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(pnDetailsLayout.createSequentialGroup().addGap(16, 16, 16).addGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jLabel3).addComponent(jLabel1)).addGap(49, 49, 49).addGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(lblNumero, javax.swing.GroupLayout.PREFERRED_SIZE, 78, javax.swing.GroupLayout.PREFERRED_SIZE).addGroup(pnDetailsLayout.createSequentialGroup().addComponent(btSave, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(btCancel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addComponent(txtNome, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 306, javax.swing.GroupLayout.PREFERRED_SIZE)).addContainerGap(120, Short.MAX_VALUE)));
        pnDetailsLayout.setVerticalGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(pnDetailsLayout.createSequentialGroup().addGap(36, 36, 36).addGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(lblNumero).addComponent(jLabel1)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(jLabel3).addComponent(txtNome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 210, Short.MAX_VALUE).addGroup(pnDetailsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(btCancel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(btSave, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addGap(36, 36, 36)));
        tabsMain.addTab("Detalhes", pnDetails);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 100.0;
        gridBagConstraints.weighty = 100.0;
        getContentPane().add(tabsMain, gridBagConstraints);
        tabsMain.getAccessibleContext().setAccessibleName("");
        pack();
    }

    private void btAddActionPerformed(java.awt.event.ActionEvent evt) {
        addData();
    }

    private void btEditActionPerformed(java.awt.event.ActionEvent evt) {
        editData();
    }

    private void btSaveActionPerformed(java.awt.event.ActionEvent evt) {
        saveData();
    }

    private void btDeleteActionPerformed(java.awt.event.ActionEvent evt) {
        deleteData();
    }

    private void btCancelActionPerformed(java.awt.event.ActionEvent evt) {
        cancelData();
    }

    private javax.swing.JButton btAdd;

    private javax.swing.JButton btCancel;

    private javax.swing.JButton btDelete;

    private javax.swing.JButton btEdit;

    private javax.swing.JButton btSave;

    private javax.swing.JLabel jLabel1;

    private javax.swing.JLabel jLabel3;

    private javax.swing.JScrollPane jScrollPane1;

    private javax.swing.JToolBar.Separator jSeparator1;

    private javax.swing.JLabel lblNumero;

    private javax.swing.JPanel pnDetails;

    private javax.swing.JPanel pnList;

    private javax.swing.JTabbedPane tabsMain;

    private javax.swing.JToolBar tbActions;

    private javax.swing.JTable tblList;

    private javax.swing.JTextField txtNome;

    private void refreshData() {
        javax.swing.table.DefaultTableModel dtm = (javax.swing.table.DefaultTableModel) tblList.getModel();
        while (dtm.getRowCount() > 0) {
            dtm.removeRow(0);
        }
        for (n501070324_Tecnico u : pesoasLnk.getTecnics()) {
            dtm.addRow(new Object[] { u.getNumero(), u.getNome() });
        }
    }

    private void addData() {
        if (tabsMain.getSelectedIndex() == 0) {
            tabsMain.setSelectedIndex(1);
        }
        lblNumero.setText("<Novo>");
        txtNome.setText("");
        txtNome.requestFocus();
    }

    private void editData() {
        if (tabsMain.getSelectedIndex() == 0) {
            tabsMain.setSelectedIndex(1);
        }
        txtNome.select(0, 9999);
        txtNome.requestFocus();
    }

    private void cancelData() {
        refreshDetails(getSelect());
    }

    private void deleteData() {
        pesoasLnk.remove(getSelect());
        refreshData();
    }

    private void saveData() {
        n501070324_Tecnico tec;
        if (lblNumero.getText().equalsIgnoreCase("<Novo>")) {
            tec = new n501070324_Tecnico();
            tec.setNome(txtNome.getText());
            pesoasLnk.add(tec);
        } else {
            tec = getSelect();
            tec.setNome(txtNome.getText());
        }
        refreshData();
        refreshDetails(tec);
    }

    private void refreshDetails(n501070324_Tecnico tec) {
        if (tec != null) {
            lblNumero.setText("" + tec.getNumero());
            txtNome.setText(tec.getNome());
        }
    }

    private n501070324_Tecnico getSelect() {
        if (tblList.getRowCount() < 1) {
            return null;
        }
        if (tblList.getSelectedRow() == -1) {
            tblList.setRowSelectionInterval(0, 0);
        }
        int id = Integer.valueOf(tblList.getModel().getValueAt(tblList.getSelectedRow(), 0).toString());
        return pesoasLnk.getTecnic(id);
    }
}
