package allensoft.javacvs.client;

public class PasswordScrambler {

    /** Scrambles a password for a pserver connection. */
    public static String scramblePassword(String password) {
        StringBuffer buf = new StringBuffer("A");
        for (int i = 0; i < password.length(); ++i) {
            char ch = password.charAt(i);
            byte newCh = (byte) (g_Shifts[((int) ch & 255)] & 255);
            buf.append((char) newCh);
        }
        return buf.toString();
    }

    public static String unScramblePassword(String scramble) {
        String pass = scramblePassword(scramble.substring(1));
        return pass.substring(1);
    }

    private static int[] g_Shifts;

    /** This code is taken from the jCVS code. */
    static {
        int i;
        int[] sh = new int[256];
        for (i = 0; i < 32; ++i) {
            sh[i] = i;
        }
        sh[i++] = 114;
        sh[i++] = 120;
        sh[i++] = 53;
        sh[i++] = 79;
        sh[i++] = 96;
        sh[i++] = 109;
        sh[i++] = 72;
        sh[i++] = 108;
        sh[i++] = 70;
        sh[i++] = 64;
        sh[i++] = 76;
        sh[i++] = 67;
        sh[i++] = 116;
        sh[i++] = 74;
        sh[i++] = 68;
        sh[i++] = 87;
        sh[i++] = 111;
        sh[i++] = 52;
        sh[i++] = 75;
        sh[i++] = 119;
        sh[i++] = 49;
        sh[i++] = 34;
        sh[i++] = 82;
        sh[i++] = 81;
        sh[i++] = 95;
        sh[i++] = 65;
        sh[i++] = 112;
        sh[i++] = 86;
        sh[i++] = 118;
        sh[i++] = 110;
        sh[i++] = 122;
        sh[i++] = 105;
        sh[i++] = 41;
        sh[i++] = 57;
        sh[i++] = 83;
        sh[i++] = 43;
        sh[i++] = 46;
        sh[i++] = 102;
        sh[i++] = 40;
        sh[i++] = 89;
        sh[i++] = 38;
        sh[i++] = 103;
        sh[i++] = 45;
        sh[i++] = 50;
        sh[i++] = 42;
        sh[i++] = 123;
        sh[i++] = 91;
        sh[i++] = 35;
        sh[i++] = 125;
        sh[i++] = 55;
        sh[i++] = 54;
        sh[i++] = 66;
        sh[i++] = 124;
        sh[i++] = 126;
        sh[i++] = 59;
        sh[i++] = 47;
        sh[i++] = 92;
        sh[i++] = 71;
        sh[i++] = 115;
        sh[i++] = 78;
        sh[i++] = 88;
        sh[i++] = 107;
        sh[i++] = 106;
        sh[i++] = 56;
        sh[i++] = 36;
        sh[i++] = 121;
        sh[i++] = 117;
        sh[i++] = 104;
        sh[i++] = 101;
        sh[i++] = 100;
        sh[i++] = 69;
        sh[i++] = 73;
        sh[i++] = 99;
        sh[i++] = 63;
        sh[i++] = 94;
        sh[i++] = 93;
        sh[i++] = 39;
        sh[i++] = 37;
        sh[i++] = 61;
        sh[i++] = 48;
        sh[i++] = 58;
        sh[i++] = 113;
        sh[i++] = 32;
        sh[i++] = 90;
        sh[i++] = 44;
        sh[i++] = 98;
        sh[i++] = 60;
        sh[i++] = 51;
        sh[i++] = 33;
        sh[i++] = 97;
        sh[i++] = 62;
        sh[i++] = 77;
        sh[i++] = 84;
        sh[i++] = 80;
        sh[i++] = 85;
        sh[i++] = 223;
        sh[i++] = 225;
        sh[i++] = 216;
        sh[i++] = 187;
        sh[i++] = 166;
        sh[i++] = 229;
        sh[i++] = 189;
        sh[i++] = 222;
        sh[i++] = 188;
        sh[i++] = 141;
        sh[i++] = 249;
        sh[i++] = 148;
        sh[i++] = 200;
        sh[i++] = 184;
        sh[i++] = 136;
        sh[i++] = 248;
        sh[i++] = 190;
        sh[i++] = 199;
        sh[i++] = 170;
        sh[i++] = 181;
        sh[i++] = 204;
        sh[i++] = 138;
        sh[i++] = 232;
        sh[i++] = 218;
        sh[i++] = 183;
        sh[i++] = 255;
        sh[i++] = 234;
        sh[i++] = 220;
        sh[i++] = 247;
        sh[i++] = 213;
        sh[i++] = 203;
        sh[i++] = 226;
        sh[i++] = 193;
        sh[i++] = 174;
        sh[i++] = 172;
        sh[i++] = 228;
        sh[i++] = 252;
        sh[i++] = 217;
        sh[i++] = 201;
        sh[i++] = 131;
        sh[i++] = 230;
        sh[i++] = 197;
        sh[i++] = 211;
        sh[i++] = 145;
        sh[i++] = 238;
        sh[i++] = 161;
        sh[i++] = 179;
        sh[i++] = 160;
        sh[i++] = 212;
        sh[i++] = 207;
        sh[i++] = 221;
        sh[i++] = 254;
        sh[i++] = 173;
        sh[i++] = 202;
        sh[i++] = 146;
        sh[i++] = 224;
        sh[i++] = 151;
        sh[i++] = 140;
        sh[i++] = 196;
        sh[i++] = 205;
        sh[i++] = 130;
        sh[i++] = 135;
        sh[i++] = 133;
        sh[i++] = 143;
        sh[i++] = 246;
        sh[i++] = 192;
        sh[i++] = 159;
        sh[i++] = 244;
        sh[i++] = 239;
        sh[i++] = 185;
        sh[i++] = 168;
        sh[i++] = 215;
        sh[i++] = 144;
        sh[i++] = 139;
        sh[i++] = 165;
        sh[i++] = 180;
        sh[i++] = 157;
        sh[i++] = 147;
        sh[i++] = 186;
        sh[i++] = 214;
        sh[i++] = 176;
        sh[i++] = 227;
        sh[i++] = 231;
        sh[i++] = 219;
        sh[i++] = 169;
        sh[i++] = 175;
        sh[i++] = 156;
        sh[i++] = 206;
        sh[i++] = 198;
        sh[i++] = 129;
        sh[i++] = 164;
        sh[i++] = 150;
        sh[i++] = 210;
        sh[i++] = 154;
        sh[i++] = 177;
        sh[i++] = 134;
        sh[i++] = 127;
        sh[i++] = 182;
        sh[i++] = 128;
        sh[i++] = 158;
        sh[i++] = 208;
        sh[i++] = 162;
        sh[i++] = 132;
        sh[i++] = 167;
        sh[i++] = 209;
        sh[i++] = 149;
        sh[i++] = 241;
        sh[i++] = 153;
        sh[i++] = 251;
        sh[i++] = 237;
        sh[i++] = 236;
        sh[i++] = 171;
        sh[i++] = 195;
        sh[i++] = 243;
        sh[i++] = 233;
        sh[i++] = 253;
        sh[i++] = 240;
        sh[i++] = 194;
        sh[i++] = 250;
        sh[i++] = 191;
        sh[i++] = 155;
        sh[i++] = 142;
        sh[i++] = 137;
        sh[i++] = 245;
        sh[i++] = 235;
        sh[i++] = 163;
        sh[i++] = 242;
        sh[i++] = 178;
        sh[i++] = 152;
        g_Shifts = sh;
    }
}
