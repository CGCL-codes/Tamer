package drm.test.simulator;

import java.io.*;
import java.util.*;

public class LogProcessor {

    /**
* Reads the log of one node generated by the newscast engine.
*/
    public static void readSpyros1Log(String file) throws IOException {
        System.err.println("Processing " + file);
        FileInputStream fis = new FileInputStream(file);
        DataInputStream dis = new DataInputStream(fis);
        long logtime = -1;
        try {
            while (true) {
                long l = dis.readLong();
                if (logtime < 0) logtime = l;
                long agentid = dis.readLong();
                int CACHESIZE = dis.readByte();
                long t = 0;
                for (int j = 0; j < CACHESIZE; ++j) {
                    int a = 0;
                    for (int off = 16; off >= 0; off -= 8) a += ((long) dis.read() << off);
                    if (j == 0) {
                        t = dis.readInt();
                        t = 0;
                    } else t += dis.readUnsignedShort();
                    System.out.println("   " + t);
                }
            }
        } catch (EOFException e) {
        }
        dis.close();
    }

    public static void main(String[] pars) {
        try {
            readSpyros1Log(pars[0]);
        } catch (Throwable t) {
            t.printStackTrace();
        }
    }
}
