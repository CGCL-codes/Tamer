package org.opennebula.bridge;

import java.io.StringReader;
import javax.xml.xpath.XPathConstants;
import javax.xml.xpath.XPathExpressionException;
import javax.xml.xpath.XPathFactory;
import org.w3c.dom.NodeList;
import org.xml.sax.InputSource;

public class XMLtester {

    static String poolnets = "<VNET_POOL><VNET><ID>1</ID><UID>0</UID><USERNAME>oneadmin</USERNAME><NAME>Int-0</NAME><TYPE>0</TYPE><BRIDGE>xenbr0</BRIDGE><PUBLIC>0</PUBLIC><TOTAL_LEASES>1</TOTAL_LEASES><TEMPLATE><BRIDGE><![CDATA[xenbr0]]></BRIDGE><NAME><![CDATA[Int-0]]></NAME><NETWORK_ADDRESS><![CDATA[192.168.0.0]]></NETWORK_ADDRESS><NETWORK_SIZE><![CDATA[C]]></NETWORK_SIZE><TYPE><![CDATA[RANGED]]></TYPE></TEMPLATE></VNET><VNET><ID>2</ID><UID>0</UID><USERNAME>oneadmin</USERNAME><NAME>Public</NAME><TYPE>1</TYPE><BRIDGE>xenbr0</BRIDGE><PUBLIC>0</PUBLIC><TOTAL_LEASES>1</TOTAL_LEASES><TEMPLATE><BRIDGE><![CDATA[xenbr0]]></BRIDGE><LEASES><IP><![CDATA[88.197.20.247]]></IP></LEASES><NAME><![CDATA[Public]]></NAME><TYPE><![CDATA[FIXED]]></TYPE></TEMPLATE></VNET></VNET_POOL>";

    static String poolhosts = "<HOST_POOL><HOST><ID>6</ID><NAME>n30.di.uoa.gr</NAME><STATE>1</STATE><IM_MAD>im_xen</IM_MAD><VM_MAD>vmm_xen</VM_MAD><TM_MAD>tm_ssh</TM_MAD><LAST_MON_TIME>1292337611</LAST_MON_TIME><CLUSTER>default</CLUSTER><TEMPLATE><ARCH><![CDATA[x86_64]]></ARCH><CPUSPEED><![CDATA[2400]]></CPUSPEED><FREECPU><![CDATA[1600]]></FREECPU><FREEMEMORY><![CDATA[39915520]]></FREEMEMORY><HOSTNAME><![CDATA[n30.di.uoa.gr]]></HOSTNAME><HYPERVISOR><![CDATA[xen]]></HYPERVISOR><MODELNAME><![CDATA[Intel(R) Xeon(R) CPU E5620 @ 2.40GHz]]></MODELNAME><NETRX><![CDATA[148039]]></NETRX><NETTX><![CDATA[23595]]></NETTX><TOTALCPU><![CDATA[1600]]></TOTALCPU><TOTALMEMORY><![CDATA[50321408]]></TOTALMEMORY><USEDCPU><![CDATA[0]]></USEDCPU><USEDMEMORY><![CDATA[10405888]]></USEDMEMORY></TEMPLATE><HOST_SHARE><HID>6</HID><DISK_USAGE>0</DISK_USAGE><MEM_USAGE>0</MEM_USAGE><CPU_USAGE>0</CPU_USAGE><MAX_DISK>0</MAX_DISK><MAX_MEM>50321408</MAX_MEM><MAX_CPU>1600</MAX_CPU><FREE_DISK>0</FREE_DISK><FREE_MEM>39915520</FREE_MEM><FREE_CPU>1600</FREE_CPU><USED_DISK>0</USED_DISK><USED_MEM>10405888</USED_MEM><USED_CPU>0</USED_CPU><RUNNING_VMS>0</RUNNING_VMS></HOST_SHARE></HOST><HOST><ID>8</ID><NAME>n32.di.uoa.gr</NAME><STATE>2</STATE><IM_MAD>im_xen</IM_MAD><VM_MAD>vmm_xen</VM_MAD><TM_MAD>tm_ssh</TM_MAD><LAST_MON_TIME>1292338001</LAST_MON_TIME><CLUSTER>default</CLUSTER><TEMPLATE><ARCH><![CDATA[x86_64]]></ARCH><CPUSPEED><![CDATA[2400]]></CPUSPEED><FREECPU><![CDATA[1599]]></FREECPU><FREEMEMORY><![CDATA[48304128]]></FREEMEMORY><HOSTNAME><![CDATA[n32.di.uoa.gr]]></HOSTNAME><HYPERVISOR><![CDATA[xen]]></HYPERVISOR><MODELNAME><![CDATA[Intel(R) Xeon(R) CPU E5620 @ 2.40GHz]]></MODELNAME><NETRX><![CDATA[76524]]></NETRX><NETTX><![CDATA[13607]]></NETTX><TOTALCPU><![CDATA[1600]]></TOTALCPU><TOTALMEMORY><![CDATA[50321408]]></TOTALMEMORY><USEDCPU><![CDATA[1]]></USEDCPU><USEDMEMORY><![CDATA[2017280]]></USEDMEMORY></TEMPLATE><HOST_SHARE><HID>8</HID><DISK_USAGE>0</DISK_USAGE><MEM_USAGE>0</MEM_USAGE><CPU_USAGE>0</CPU_USAGE><MAX_DISK>0</MAX_DISK><MAX_MEM>50321408</MAX_MEM><MAX_CPU>1600</MAX_CPU><FREE_DISK>0</FREE_DISK><FREE_MEM>48304128</FREE_MEM><FREE_CPU>1599</FREE_CPU><USED_DISK>0</USED_DISK><USED_MEM>2017280</USED_MEM><USED_CPU>1</USED_CPU><RUNNING_VMS>0</RUNNING_VMS></HOST_SHARE></HOST><HOST><ID>9</ID><NAME>n33.di.uoa.gr</NAME><STATE>2</STATE><IM_MAD>im_xen</IM_MAD><VM_MAD>vmm_xen</VM_MAD><TM_MAD>tm_ssh</TM_MAD><LAST_MON_TIME>1292337941</LAST_MON_TIME><CLUSTER>default</CLUSTER><TEMPLATE><ARCH><![CDATA[x86_64]]></ARCH><CPUSPEED><![CDATA[2400]]></CPUSPEED><FREECPU><![CDATA[1599]]></FREECPU><FREEMEMORY><![CDATA[48304128]]></FREEMEMORY><HOSTNAME><![CDATA[n33.di.uoa.gr]]></HOSTNAME><HYPERVISOR><![CDATA[xen]]></HYPERVISOR><MODELNAME><![CDATA[Intel(R) Xeon(R) CPU E5620 @ 2.40GHz]]></MODELNAME><NETRX><![CDATA[76458]]></NETRX><NETTX><![CDATA[13573]]></NETTX><TOTALCPU><![CDATA[1600]]></TOTALCPU><TOTALMEMORY><![CDATA[50321408]]></TOTALMEMORY><USEDCPU><![CDATA[1]]></USEDCPU><USEDMEMORY><![CDATA[2017280]]></USEDMEMORY></TEMPLATE><HOST_SHARE><HID>9</HID><DISK_USAGE>0</DISK_USAGE><MEM_USAGE>0</MEM_USAGE><CPU_USAGE>0</CPU_USAGE><MAX_DISK>0</MAX_DISK><MAX_MEM>50321408</MAX_MEM><MAX_CPU>1600</MAX_CPU><FREE_DISK>0</FREE_DISK><FREE_MEM>48304128</FREE_MEM><FREE_CPU>1599</FREE_CPU><USED_DISK>0</USED_DISK><USED_MEM>2017280</USED_MEM><USED_CPU>1</USED_CPU><RUNNING_VMS>0</RUNNING_VMS></HOST_SHARE></HOST><HOST><ID>10</ID><NAME>n31.di.uoa.gr</NAME><STATE>2</STATE><IM_MAD>im_xen</IM_MAD><VM_MAD>vmm_xen</VM_MAD><TM_MAD>tm_ssh</TM_MAD><LAST_MON_TIME>1292337881</LAST_MON_TIME><CLUSTER>default</CLUSTER><TEMPLATE><ARCH><![CDATA[x86_64]]></ARCH><CPUSPEED><![CDATA[2400]]></CPUSPEED><FREECPU><![CDATA[1600]]></FREECPU><FREEMEMORY><![CDATA[46206976]]></FREEMEMORY><HOSTNAME><![CDATA[n31.di.uoa.gr]]></HOSTNAME><HYPERVISOR><![CDATA[xen]]></HYPERVISOR><MODELNAME><![CDATA[Intel(R) Xeon(R) CPU E5620 @ 2.40GHz]]></MODELNAME><NETRX><![CDATA[34461144]]></NETRX><NETTX><![CDATA[196136]]></NETTX><TOTALCPU><![CDATA[1600]]></TOTALCPU><TOTALMEMORY><![CDATA[50321408]]></TOTALMEMORY><USEDCPU><![CDATA[0]]></USEDCPU><USEDMEMORY><![CDATA[4114432]]></USEDMEMORY></TEMPLATE><HOST_SHARE><HID>10</HID><DISK_USAGE>0</DISK_USAGE><MEM_USAGE>2097152</MEM_USAGE><CPU_USAGE>40</CPU_USAGE><MAX_DISK>0</MAX_DISK><MAX_MEM>50321408</MAX_MEM><MAX_CPU>1600</MAX_CPU><FREE_DISK>0</FREE_DISK><FREE_MEM>46206976</FREE_MEM><FREE_CPU>1600</FREE_CPU><USED_DISK>0</USED_DISK><USED_MEM>4114432</USED_MEM><USED_CPU>0</USED_CPU><RUNNING_VMS>2</RUNNING_VMS></HOST_SHARE></HOST></HOST_POOL>";

    static String poolres = "<VM_POOL><VM><ID>11</ID><UID>0</UID><USERNAME>oneadmin</USERNAME><NAME>testvm1</NAME><LAST_POLL>1292240322</LAST_POLL><STATE>3</STATE><LCM_STATE>3</LCM_STATE><STIME>1291911419</STIME><ETIME>0</ETIME><DEPLOY_ID>one-11</DEPLOY_ID><MEMORY>1048388</MEMORY><CPU>0</CPU><NET_TX>66</NET_TX><NET_RX>41464</NET_RX><LAST_SEQ>0</LAST_SEQ><TEMPLATE><CPU><![CDATA[0.2]]></CPU><DISK><DISK_ID><![CDATA[0]]></DISK_ID><DRIVER><![CDATA[file:]]></DRIVER><READONLY><![CDATA[no]]></READONLY><SOURCE><![CDATA[/fn/a/ONE-repository/gcube-domains/public/mini-centos/disk.img]]></SOURCE><TARGET><![CDATA[xvda]]></TARGET></DISK><DISK><DISK_ID><![CDATA[1]]></DISK_ID><DRIVER><![CDATA[file:]]></DRIVER><SIZE><![CDATA[256]]></SIZE><TARGET><![CDATA[xvdb1]]></TARGET><TYPE><![CDATA[swap]]></TYPE></DISK><MEMORY><![CDATA[1024]]></MEMORY><NAME><![CDATA[testvm2]]></NAME><NIC><BRIDGE><![CDATA[xenbr0]]></BRIDGE><IP><![CDATA[192.168.0.5]]></IP><MAC><![CDATA[02:00:c0:a8:00:05]]></MAC><NETWORK><![CDATA[Int-0]]></NETWORK><NETWORK_ID><![CDATA[1]]></NETWORK_ID></NIC><OS><BOOTLOADER><![CDATA[/usr/bin/pygrub]]></BOOTLOADER></OS><VMID><![CDATA[11]]></VMID></TEMPLATE><HISTORY><SEQ>0</SEQ><HOSTNAME>n31.di.uoa.gr</HOSTNAME><HID>10</HID><STIME>1291911432</STIME><ETIME>0</ETIME><PSTIME>1291911432</PSTIME><PETIME>1291911516</PETIME><RSTIME>1291911516</RSTIME><RETIME>0</RETIME><ESTIME>0</ESTIME><EETIME>0</EETIME><REASON>0</REASON></HISTORY></VM><VM><ID>12</ID><UID>0</UID><USERNAME>oneadmin</USERNAME><NAME>testvm1</NAME><LAST_POLL>1292240292</LAST_POLL><STATE>3</STATE><LCM_STATE>3</LCM_STATE><STIME>1291911989</STIME><ETIME>0</ETIME><DEPLOY_ID>one-12</DEPLOY_ID><MEMORY>1048132</MEMORY><CPU>0</CPU><NET_TX>4707</NET_TX><NET_RX>94029</NET_RX><LAST_SEQ>0</LAST_SEQ><TEMPLATE><CPU><![CDATA[0.2]]></CPU><DISK><DISK_ID><![CDATA[0]]></DISK_ID><DRIVER><![CDATA[file:]]></DRIVER><READONLY><![CDATA[no]]></READONLY><SOURCE><![CDATA[/fn/a/ONE-repository/gcube-domains/public/mini-centos/disk.img]]></SOURCE><TARGET><![CDATA[xvda]]></TARGET></DISK><DISK><DISK_ID><![CDATA[1]]></DISK_ID><DRIVER><![CDATA[file:]]></DRIVER><SIZE><![CDATA[256]]></SIZE><TARGET><![CDATA[xvdb1]]></TARGET><TYPE><![CDATA[swap]]></TYPE></DISK><MEMORY><![CDATA[1024]]></MEMORY><NAME><![CDATA[testvm1]]></NAME><NIC><BRIDGE><![CDATA[xenbr0]]></BRIDGE><IP><![CDATA[192.168.0.6]]></IP><MAC><![CDATA[02:00:c0:a8:00:06]]></MAC><NETWORK><![CDATA[Int-0]]></NETWORK><NETWORK_ID><![CDATA[1]]></NETWORK_ID></NIC><NIC><BRIDGE><![CDATA[xenbr0]]></BRIDGE><IP><![CDATA[88.197.20.247]]></IP><MAC><![CDATA[02:00:58:c5:14:f7]]></MAC><NETWORK><![CDATA[Public]]></NETWORK><NETWORK_ID><![CDATA[2]]></NETWORK_ID></NIC><OS><BOOTLOADER><![CDATA[/usr/bin/pygrub]]></BOOTLOADER></OS><VMID><![CDATA[12]]></VMID></TEMPLATE><HISTORY><SEQ>0</SEQ><HOSTNAME>n31.di.uoa.gr</HOSTNAME><HID>10</HID><STIME>1291912002</STIME><ETIME>0</ETIME><PSTIME>1291912002</PSTIME><PETIME>1291912087</PETIME><RSTIME>1291912087</RSTIME><RETIME>0</RETIME><ESTIME>0</ESTIME><EETIME>0</EETIME><REASON>0</REASON></HISTORY></VM></VM_POOL>";

    static String query = "/VM_POOL/VM/NAME/text()";

    public static void main(String[] args) {
        try {
            NodeList ans = (NodeList) XPathFactory.newInstance().newXPath().evaluate(query, new InputSource(new StringReader(poolres)), XPathConstants.NODESET);
            for (int i = 0; i < ans.getLength(); i++) {
                System.out.println("Ans: " + ans.item(i).getTextContent());
            }
        } catch (XPathExpressionException e) {
            e.printStackTrace();
        }
    }
}
