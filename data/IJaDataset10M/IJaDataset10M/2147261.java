package org.ttalbott.mytelly;

import java.awt.GridBagConstraints;
import javax.swing.JPanel;

/**
 *
 * @author  Tom Talbott
 */
public class RetryDialog extends javax.swing.JDialog {

    boolean m_cancelled = false;

    int m_seconds = 10;

    /** Creates new form RetryDialog */
    public RetryDialog(java.awt.Dialog parent, boolean modal, String title, String desc, int seconds) {
        super(parent, modal);
        initComponents();
        setLocationRelativeTo(parent);
        m_seconds = seconds;
        setTitle(title);
        jTextArea1.setText(desc);
        updateLabel();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    private void initComponents() {
        timer1 = new Timer();
        timer1.addTimerListener(new TimerListener() {

            public void onTime(java.awt.event.ActionEvent evt) {
                timer1OnTime(evt);
            }
        });
        addWindowListener(new java.awt.event.WindowAdapter() {

            public void windowClosing(java.awt.event.WindowEvent evt) {
                closeDialog(evt);
            }
        });
        this.setContentPane(getJPanelContent());
        pack();
    }

    private void jButtonRetryActionPerformed(java.awt.event.ActionEvent evt) {
        closeDialog(null);
    }

    private void jButtonSkipActionPerformed(java.awt.event.ActionEvent evt) {
        m_cancelled = true;
        closeDialog(null);
    }

    private void timer1OnTime(java.awt.event.ActionEvent evt) {
        Thread.yield();
        if (--m_seconds < 1) {
            closeDialog(null);
        } else {
            updateLabel();
        }
    }

    /** Closes the dialog */
    private void closeDialog(java.awt.event.WindowEvent evt) {
        setVisible(false);
        dispose();
    }

    private void updateLabel() {
        jLabel1.setText("Retry in ... " + m_seconds + " seconds");
    }

    public void show() {
        super.show();
    }

    public boolean getCancel() {
        return m_cancelled;
    }

    private Timer timer1;

    private javax.swing.JTextArea jTextArea1;

    private javax.swing.JLabel jLabel1;

    private javax.swing.JButton jButtonRetry;

    private javax.swing.JButton jButtonSkip;

    private JPanel jPanelContent = null;

    /**
	 * This method initializes jPanelContent	
	 * 	
	 * @return javax.swing.JPanel	
	 */
    private JPanel getJPanelContent() {
        if (jPanelContent == null) {
            jPanelContent = new JPanel();
            jPanelContent.setLayout(new java.awt.GridBagLayout());
            java.awt.GridBagConstraints gridBagConstraints1;
            gridBagConstraints1 = new java.awt.GridBagConstraints();
            gridBagConstraints1.gridx = 0;
            gridBagConstraints1.gridy = 0;
            gridBagConstraints1.gridwidth = 2;
            gridBagConstraints1.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints1.ipady = 23;
            gridBagConstraints1.insets = new java.awt.Insets(10, 10, 10, 10);
            jPanelContent.add(getJTextArea1(), gridBagConstraints1);
            GridBagConstraints gridBagConstraints2 = new java.awt.GridBagConstraints();
            gridBagConstraints2.gridx = 0;
            gridBagConstraints2.gridy = 1;
            gridBagConstraints2.gridwidth = 2;
            gridBagConstraints2.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints2.ipadx = 13;
            gridBagConstraints2.insets = new java.awt.Insets(10, 10, 10, 10);
            jPanelContent.add(getJLabel1(), gridBagConstraints2);
            GridBagConstraints gridBagConstraints3 = new java.awt.GridBagConstraints();
            gridBagConstraints3.gridx = 0;
            gridBagConstraints3.gridy = 2;
            gridBagConstraints3.insets = new java.awt.Insets(0, 80, 0, 5);
            gridBagConstraints3.anchor = java.awt.GridBagConstraints.EAST;
            jPanelContent.add(getJButtonRetry(), gridBagConstraints3);
            GridBagConstraints gridBagConstraints4 = new java.awt.GridBagConstraints();
            gridBagConstraints4.gridx = 1;
            gridBagConstraints4.gridy = 2;
            gridBagConstraints4.insets = new java.awt.Insets(10, 5, 10, 10);
            gridBagConstraints4.anchor = java.awt.GridBagConstraints.WEST;
            jPanelContent.add(getJButtonSkip(), gridBagConstraints4);
        }
        return jPanelContent;
    }

    /**
	 * 
	 */
    private javax.swing.JButton getJButtonSkip() {
        if (jButtonSkip == null) {
            jButtonSkip = new javax.swing.JButton();
            jButtonSkip.setText("Skip");
            jButtonSkip.addActionListener(new java.awt.event.ActionListener() {

                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButtonSkipActionPerformed(evt);
                }
            });
        }
        return jButtonSkip;
    }

    /**
	 * 
	 */
    private javax.swing.JButton getJButtonRetry() {
        if (jButtonRetry == null) {
            jButtonRetry = new javax.swing.JButton();
            jButtonRetry.setText("Retry Now!");
            jButtonRetry.addActionListener(new java.awt.event.ActionListener() {

                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButtonRetryActionPerformed(evt);
                }
            });
        }
        return jButtonRetry;
    }

    /**
	 * 
	 */
    private javax.swing.JLabel getJLabel1() {
        if (jLabel1 == null) {
            jLabel1 = new javax.swing.JLabel();
            jLabel1.setText("Retry in ... x seconds");
            jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
            jLabel1.setFont(new java.awt.Font("Arial", 0, 12));
        }
        return jLabel1;
    }

    /**
	 * 
	 */
    private javax.swing.JTextArea getJTextArea1() {
        if (jTextArea1 == null) {
            jTextArea1 = new javax.swing.JTextArea();
            jTextArea1.setWrapStyleWord(true);
            jTextArea1.setLineWrap(true);
            jTextArea1.setFont(new java.awt.Font("Arial", 0, 12));
            jTextArea1.setPreferredSize(new java.awt.Dimension(300, 17));
            jTextArea1.setMinimumSize(new java.awt.Dimension(300, 17));
            jTextArea1.setOpaque(false);
        }
        return jTextArea1;
    }
}
