package formaPago;

import java.util.*;
import utilidad.vo.*;
import utilidad.componentes.*;
import utilidad.*;
import java.awt.event.*;
import javax.swing.*;

/**
 *
 * @author  Sergio
 */
public class DatosFormaPago extends javax.swing.JFrame {

    private static final ResourceBundle bundle = java.util.ResourceBundle.getBundle("formaPago/Bundle");

    public DatosFormaPago(FormaPagoVO formaPago) {
        initComponents();
        this.formaPago = formaPago;
        inicializarForm();
    }

    public DatosFormaPago(FormaPagoVO formaPago, MiTable tablaOrigen) {
        initComponents();
        this.formaPago = formaPago;
        this.tablaOrigen = tablaOrigen;
        inicializarForm();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        jLTitulo = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        jLError = new javax.swing.JLabel();
        jTPDatos = new javax.swing.JTabbedPane();
        jPDatos = new javax.swing.JPanel();
        jTFNombre = new utilidad.componentes.MiJTFTexto();
        jLNombre = new javax.swing.JLabel();
        jCBEstado = new utilidad.componentes.MiJComboBox();
        jLEstado = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTANotas = new javax.swing.JTextArea();
        jLNotas = new javax.swing.JLabel();
        jCkBRecibo = new javax.swing.JCheckBox();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMConfiguracion = new javax.swing.JMenu();
        jMICreacionModificacion = new javax.swing.JMenuItem();
        jMAyuda = new javax.swing.JMenu();
        jMIPaginaInicio = new javax.swing.JMenuItem();
        jBEliminar = new javax.swing.JButton();
        jBCancelar = new javax.swing.JButton();
        jBGuardar = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        jPanel2.setVisible(false);
        jCkBRemesable = new javax.swing.JCheckBox();
        jCkBContado = new javax.swing.JCheckBox();
        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setName("Form");
        setResizable(false);
        addWindowListener(new java.awt.event.WindowAdapter() {

            public void windowClosed(java.awt.event.WindowEvent evt) {
                formWindowClosed(evt);
            }
        });
        getContentPane().setLayout(null);
        jLTitulo.setFont(new java.awt.Font("Arial", 1, 24));
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("formaPago/Bundle");
        jLTitulo.setText(bundle.getString("DatosFormaPago.jLTitulo.text"));
        jLTitulo.setToolTipText(bundle.getString("DatosFormaPago.jLTitulo.toolTipText"));
        jLTitulo.setName("jLTitulo");
        getContentPane().add(jLTitulo);
        jLTitulo.setBounds(10, 30, 290, 29);
        jSeparator1.setName("jSeparator1");
        getContentPane().add(jSeparator1);
        jSeparator1.setBounds(0, 70, 490, 10);
        jLError.setFont(new java.awt.Font("Arial", 1, 11));
        jLError.setForeground(java.awt.Color.red);
        jLError.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLError.setText(bundle.getString("DatosFormaPago.jLError.text"));
        jLError.setName("jLError");
        jLError.setText("");
        getContentPane().add(jLError);
        jLError.setBounds(10, 390, 450, 20);
        jTPDatos.setToolTipText(bundle.getString("DatosFormaPago.jTPDatos.toolTipText"));
        jTPDatos.setFont(new java.awt.Font("Arial", 0, 11));
        jTPDatos.setName("jTPDatos");
        jPDatos.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPDatos.setToolTipText(bundle.getString("DatosFormaPago.jPDatos.toolTipText"));
        jPDatos.setName("jPDatos");
        jPDatos.setLayout(null);
        jTFNombre.setName("jTFNombre");
        jPDatos.add(jTFNombre);
        jTFNombre.setBounds(10, 70, 410, 20);
        jLNombre.setText(bundle.getString("DatosFormaPago.jLNombre.text"));
        jLNombre.setName("jLNombre");
        jPDatos.add(jLNombre);
        jLNombre.setBounds(10, 50, 80, 14);
        jCBEstado.setName("jCBEstado");
        jPDatos.add(jCBEstado);
        jCBEstado.setBounds(60, 20, 150, 20);
        jLEstado.setText(bundle.getString("DatosFormaPago.jLEstado.text"));
        jLEstado.setName("jLEstado");
        jPDatos.add(jLEstado);
        jLEstado.setBounds(10, 20, 50, 14);
        jScrollPane1.setName("jScrollPane1");
        jTANotas.setColumns(20);
        jTANotas.setRows(5);
        jTANotas.setName("jTANotas");
        jScrollPane1.setViewportView(jTANotas);
        jPDatos.add(jScrollPane1);
        jScrollPane1.setBounds(10, 120, 410, 96);
        jLNotas.setText(bundle.getString("DatosFormaPago.jLNotas.text"));
        jLNotas.setName("jLNotas");
        jPDatos.add(jLNotas);
        jLNotas.setBounds(10, 100, 70, 14);
        jCkBRecibo.setText(bundle.getString("DatosFormaPago.jCkBRecibo.text"));
        jCkBRecibo.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jCkBRecibo.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
        jCkBRecibo.setName("jCkBRecibo");
        jPDatos.add(jCkBRecibo);
        jCkBRecibo.setBounds(280, 20, 140, 23);
        jTPDatos.addTab(bundle.getString("DatosFormaPago.jPDatos.TabConstraints.tabTitle"), jPDatos);
        getContentPane().add(jTPDatos);
        jTPDatos.setBounds(20, 80, 450, 270);
        java.util.ResourceBundle bundle1 = java.util.ResourceBundle.getBundle("cliente/Bundle");
        jTPDatos.getAccessibleContext().setAccessibleName(bundle1.getString("DatosCliente.jTPDatos.AccessibleContext.accessibleName"));
        jMenuBar1.setName("jMenuBar1");
        jMConfiguracion.setText(bundle.getString("DatosFormaPago.jMConfiguracion.text"));
        jMConfiguracion.setName("jMConfiguracion");
        jMICreacionModificacion.setText(bundle.getString("DatosFormaPago.jMICreacionModificacion.text"));
        jMICreacionModificacion.setName("jMICreacionModificacion");
        jMICreacionModificacion.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMICreacionModificacionActionPerformed(evt);
            }
        });
        jMConfiguracion.add(jMICreacionModificacion);
        jMenuBar1.add(jMConfiguracion);
        jMAyuda.setText(bundle.getString("DatosFormaPago.jMAyuda.text"));
        jMAyuda.setName("jMAyuda");
        jMIPaginaInicio.setText(bundle.getString("DatosFormaPago.jMIPaginaInicio.text"));
        jMIPaginaInicio.setName("jMIPaginaInicio");
        jMIPaginaInicio.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMIPaginaInicioActionPerformed(evt);
            }
        });
        jMAyuda.add(jMIPaginaInicio);
        jMenuBar1.add(jMAyuda);
        getContentPane().add(jMenuBar1);
        jMenuBar1.setBounds(0, 0, 490, 21);
        jBEliminar.setText(bundle.getString("DatosFormaPago.jBEliminar.text"));
        jBEliminar.setName("jBEliminar");
        jBEliminar.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBEliminarActionPerformed(evt);
            }
        });
        getContentPane().add(jBEliminar);
        jBEliminar.setBounds(20, 360, 90, 23);
        jBCancelar.setText(bundle.getString("DatosFormaPago.jBCancelar.text"));
        jBCancelar.setName("jBCancelar");
        jBCancelar.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBCancelarActionPerformed(evt);
            }
        });
        getContentPane().add(jBCancelar);
        jBCancelar.setBounds(280, 360, 90, 23);
        jBGuardar.setText(bundle.getString("DatosFormaPago.jBGuardar.text"));
        jBGuardar.setName("jBGuardar");
        jBGuardar.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBGuardarActionPerformed(evt);
            }
        });
        getContentPane().add(jBGuardar);
        jBGuardar.setBounds(380, 360, 90, 23);
        jPanel2.setBackground(new java.awt.Color(153, 153, 153));
        jPanel2.setName("jPanel2");
        jCkBRemesable.setText(bundle.getString("DatosFormaPago.jCkBRemesable.text"));
        jCkBRemesable.setName("jCkBRemesable");
        jPanel2.add(jCkBRemesable);
        jCkBContado.setText(bundle.getString("DatosFormaPago.jCkBContado.text"));
        jCkBContado.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jCkBContado.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
        jCkBContado.setName("jCkBContado");
        jPanel2.add(jCkBContado);
        getContentPane().add(jPanel2);
        jPanel2.setBounds(480, 140, 140, 100);
        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width - 490) / 2, (screenSize.height - 448) / 2, 490, 448);
    }

    private void jBGuardarActionPerformed(java.awt.event.ActionEvent evt) {
        guardar(true);
    }

    private void jBCancelarActionPerformed(java.awt.event.ActionEvent evt) {
        cancelar();
    }

    private void jBEliminarActionPerformed(java.awt.event.ActionEvent evt) {
        eliminar();
    }

    private void jMICreacionModificacionActionPerformed(java.awt.event.ActionEvent evt) {
        verCreacionModificacion();
    }

    private void jMIPaginaInicioActionPerformed(java.awt.event.ActionEvent evt) {
        irPaginaInicio();
    }

    private void formWindowClosed(java.awt.event.WindowEvent evt) {
        Util.eliminarReferenciaLista(this);
    }

    private boolean guardar(boolean cerrarVentana) {
        try {
            validarObjeto();
            cargarObjeto();
            int numRegs = 0;
            if (formaPago.getId() == -1) {
                numRegs = FormaPagoUtil.insertar(formaPago);
                if ((numRegs > 0) && (tablaOrigen != null)) {
                    tablaOrigen.añadirObjeto(formaPago);
                }
            } else {
                numRegs = FormaPagoUtil.actualizar(formaPago);
                if ((numRegs > 0) && (tablaOrigen != null)) {
                    tablaOrigen.modificarObjeto(formaPago);
                }
            }
            if (cerrarVentana && (numRegs > 0)) {
                this.dispose();
            }
            return true;
        } catch (MiExcepcion ex) {
            if (!ex.getDescripcion().isEmpty()) {
                jLError.setText(ex.getDescripcion());
            }
            javax.swing.JComponent componente = ex.getComponente();
            if (componente != null) {
                componente.requestFocus();
                componente.setBackground(java.awt.Color.LIGHT_GRAY);
            }
            return false;
        } catch (Exception ex) {
            jLError.setText(ex.getMessage());
            return false;
        }
    }

    private void cancelar() {
        this.dispose();
    }

    private void eliminar() {
        int resp = JOptionPane.showConfirmDialog(this, bundle.getString("¿Desea_Eliminar_Esta_Forma_de_Pago?"), "", JOptionPane.YES_NO_OPTION);
        if (resp == JOptionPane.YES_OPTION) {
            int numRegs = FormaPagoUtil.eliminar(this.formaPago.getId());
            if ((numRegs > 0) && (tablaOrigen != null)) {
                tablaOrigen.eliminarObjeto(this.formaPago);
            }
            this.dispose();
        }
    }

    private void irPaginaInicio() {
        inicio.InicioApp.cerrarVentanasAbiertas();
        this.dispose();
    }

    private void verCreacionModificacion() {
        operador.DatosCreacionModificacion frmDatos = new operador.DatosCreacionModificacion(this, formaPago);
        Util.mostrarVentana(frmDatos);
    }

    private void inicializarForm() {
        Util.cambiarIcono(this);
        ajustarVisibilidades();
        cargarCombos();
        this.setTitle(bundle.getString("Datos_Formas_de_Pago"));
        jLTitulo.setText(bundle.getString("Datos_Formas_de_Pago"));
        mostrarObjeto();
    }

    private void ajustarVisibilidades() {
    }

    private void cargarCombos() {
        cargarComboEstados();
    }

    private void cargarComboEstados() {
        ArrayList<ItemComboVO> listaItems = Util.listadoCamposLVAL("ESTADO");
        jCBEstado.cargarLista(listaItems);
        jCBEstado.setSelectedIndex(0);
    }

    private void cargarObjeto() {
        formaPago.setNombre(jTFNombre.getText());
        formaPago.setEstado(jCBEstado.getSelectedNombre());
        formaPago.setRecibo(jCkBRecibo.isSelected());
        formaPago.setContado(jCkBContado.isSelected());
        formaPago.setRemesable(jCkBRemesable.isSelected());
        formaPago.setNotas(jTANotas.getText());
    }

    private void mostrarObjeto() {
        jTFNombre.setText(formaPago.getNombre());
        jCBEstado.setSelectedNombre(formaPago.getEstado());
        jCkBRecibo.setSelected(formaPago.esRecibo());
        jCkBContado.setSelected(formaPago.esContado());
        jCkBRemesable.setSelected(formaPago.esRemesable());
        jTANotas.setText(formaPago.getNotas());
    }

    private void validarObjeto() throws MiExcepcion {
        if (jTFNombre.getText().isEmpty()) {
            throw new MiExcepcion(jTFNombre, bundle.getString("El_Nombre_No_Puede_Ser_Nulo"));
        }
    }

    private FormaPagoVO formaPago = new FormaPagoVO();

    private MiTable tablaOrigen = null;

    public MiTableModel modelo = null;

    @Override
    protected JRootPane createRootPane() {
        JRootPane rootPane = new JRootPane();
        Action actionEscape = new AbstractAction() {

            public void actionPerformed(ActionEvent actionEvent) {
                setVisible(false);
            }
        };
        Action actionEnter = new AbstractAction() {

            public void actionPerformed(ActionEvent actionEvent) {
                guardar(true);
            }
        };
        KeyStroke strokeEscape = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0);
        KeyStroke strokeEnter = KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0);
        rootPane.registerKeyboardAction(actionEscape, strokeEscape, JComponent.WHEN_IN_FOCUSED_WINDOW);
        rootPane.registerKeyboardAction(actionEnter, strokeEnter, JComponent.WHEN_IN_FOCUSED_WINDOW);
        return rootPane;
    }

    private javax.swing.JButton jBCancelar;

    private javax.swing.JButton jBEliminar;

    private javax.swing.JButton jBGuardar;

    private utilidad.componentes.MiJComboBox jCBEstado;

    private javax.swing.JCheckBox jCkBContado;

    private javax.swing.JCheckBox jCkBRecibo;

    private javax.swing.JCheckBox jCkBRemesable;

    private javax.swing.JLabel jLError;

    private javax.swing.JLabel jLEstado;

    private javax.swing.JLabel jLNombre;

    private javax.swing.JLabel jLNotas;

    private javax.swing.JLabel jLTitulo;

    private javax.swing.JMenu jMAyuda;

    private javax.swing.JMenu jMConfiguracion;

    private javax.swing.JMenuItem jMICreacionModificacion;

    private javax.swing.JMenuItem jMIPaginaInicio;

    private javax.swing.JMenuBar jMenuBar1;

    private javax.swing.JPanel jPDatos;

    private javax.swing.JPanel jPanel2;

    private javax.swing.JScrollPane jScrollPane1;

    private javax.swing.JSeparator jSeparator1;

    private javax.swing.JTextArea jTANotas;

    private utilidad.componentes.MiJTFTexto jTFNombre;

    private javax.swing.JTabbedPane jTPDatos;
}
