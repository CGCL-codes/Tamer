package org.personalsmartspace.cm.reasoning.activity.signals;

import java.util.ArrayList;
import org.personalsmartspace.cm.reasoning.activity.interfaces.ISensorUnit;
import org.personalsmartspace.cm.reasoning.activity.interfaces.ISignal;
import org.personalsmartspace.cm.reasoning.activity.utils.FIR;

public class SignalFilteredNormOfTheAccelerationBelow2Hz extends Signal_FilteredSignal {

    static final double[] FIR_LPF_2_HZ = { -0.00628642205248234, -0.000782131630566210, -0.000715031298584862, -0.000564616366659814, -0.000326408249376042, -4.56787621610087e-06, 0.000396038528472139, 0.000862236995949261, 0.00138053189465806, 0.00192840350824164, 0.00248305718448949, 0.00301438565465465, 0.00349492763899950, 0.00389130049362861, 0.00417449658492485, 0.00431244055611853, 0.00428446988017792, 0.00406554951256853, 0.00364309400720442, 0.00301070672220203, 0.00217008655446703, 0.00113073955547155, -8.50150074021067e-05, -0.00144565501981211, -0.00290864449705622, -0.00442255785352324, -0.00592694586910870, -0.00735457608544915, -0.00863780301645565, -0.00970575350290891, -0.0104931825265075, -0.0109025604065507, -0.0108982017600330, -0.0104165077668483, -0.00940473101295186, -0.00784111082111052, -0.00570135795237978, -0.00299206324340827, 0.000275821795814142, 0.00406102592368964, 0.00831608491778014, 0.0129661730833569, 0.0179323508220656, 0.0231108328182657, 0.0283982216746413, 0.0336715835724506, 0.0388180564111641, 0.0437093017601825, 0.0482288847887421, 0.0522689739921875, 0.0557258221833512, 0.0585097732386627, 0.0605522426157663, 0.0617990269215377, 0.0622191115192396, 0.0617990269215377, 0.0605522426157663, 0.0585097732386627, 0.0557258221833512, 0.0522689739921875, 0.0482288847887421, 0.0437093017601825, 0.0388180564111641, 0.0336715835724506, 0.0283982216746413, 0.0231108328182657, 0.0179323508220656, 0.0129661730833569, 0.00831608491778014, 0.00406102592368964, 0.000275821795814142, -0.00299206324340827, -0.00570135795237978, -0.00784111082111052, -0.00940473101295186, -0.0104165077668483, -0.0108982017600330, -0.0109025604065507, -0.0104931825265075, -0.00970575350290891, -0.00863780301645565, -0.00735457608544915, -0.00592694586910870, -0.00442255785352324, -0.00290864449705622, -0.00144565501981211, -8.50150074021067e-05, 0.00113073955547155, 0.00217008655446703, 0.00301070672220203, 0.00364309400720442, 0.00406554951256853, 0.00428446988017792, 0.00431244055611853, 0.00417449658492485, 0.00389130049362861, 0.00349492763899950, 0.00301438565465465, 0.00248305718448949, 0.00192840350824164, 0.00138053189465806, 0.000862236995949261, 0.000396038528472139, -4.56787621610087e-06, -0.000326408249376042, -0.000564616366659814, -0.000715031298584862, -0.000782131630566210, -0.00628642205248234 };

    private SignalNormAcceleration rawSignal;

    private FIR filter;

    public SignalFilteredNormOfTheAccelerationBelow2Hz(ArrayList<ISensorUnit> iSensor, ArrayList<ISignal> iSignal) {
        super(iSensor, iSignal);
        for (ISignal any : iSignal) {
            if (any instanceof SignalNormAcceleration) {
                this.rawSignal = (SignalNormAcceleration) any;
            }
        }
        this.filter = new FIR(FIR_LPF_2_HZ);
    }

    public void updateSignal() {
        double a = this.filter.getOutputSample((Double) this.rawSignal.getLastSample().getValue());
        super.updateSignal(a);
    }
}
