package subget.gui;

import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import javax.swing.AbstractAction;
import subget.CharsetTranslation;
import subget.bundles.Bundles;

/**
 *
 * @author  povder
 */
public class CharsetDialog extends javax.swing.JDialog {

    /** Creates new form CharsetDialog */
    public CharsetDialog(String filename, boolean detectEnabled) {
        super((java.awt.Frame) null, true);
        initComponents();
        autodetectCheckBox.setVisible(detectEnabled);
        pathLabel.setText(filename);
        setLocationRelativeTo(null);
        String[] encodings = CharsetTranslation.listEncodings();
        for (int i = 0; i < encodings.length; ++i) {
            charsetComboBox.addItem(encodings[i]);
        }
        charsetComboBox.setSelectedItem("UTF-8");
        okButton.addActionListener(new AbstractAction() {

            public void actionPerformed(ActionEvent e) {
                if (autodetectCheckBox.isSelected()) {
                    value = "autodetect";
                } else {
                    value = (String) charsetComboBox.getSelectedItem();
                }
                dispose();
            }
        });
        cancelButton.addActionListener(new AbstractAction() {

            public void actionPerformed(ActionEvent e) {
                value = null;
                dispose();
            }
        });
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        pleaseLabel = new javax.swing.JLabel();
        pathLabel = new javax.swing.JLabel();
        okButton = new javax.swing.JButton();
        cancelButton = new javax.swing.JButton();
        autodetectCheckBox = new javax.swing.JCheckBox();
        charsetComboBox = new javax.swing.JComboBox();
        iconLabel = new javax.swing.JLabel();
        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
        setLocationByPlatform(true);
        setResizable(false);
        addKeyListener(new java.awt.event.KeyAdapter() {

            public void keyPressed(java.awt.event.KeyEvent evt) {
                formKeyPressed(evt);
            }
        });
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("subget/bundles/Bundle");
        pleaseLabel.setText(bundle.getString("CharsetDialog.pleaseLabel.text_1"));
        pathLabel.setText(bundle.getString("CharsetDialog.pathLabel.text_1"));
        okButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/subget/gui/icons/dialogOk22.png")));
        okButton.setText(bundle.getString("CharsetDialog.okButton.text_1"));
        cancelButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/subget/gui/icons/dialogCancel22.png")));
        cancelButton.setText(bundle.getString("CharsetDialog.cancelButton.text_1"));
        autodetectCheckBox.setText(bundle.getString("CharsetDialog.autodetectCheckBox.text_1"));
        autodetectCheckBox.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                autodetectCheckBoxActionPerformed(evt);
            }
        });
        iconLabel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/subget/gui/icons/optionsCharset40.png")));
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(layout.createSequentialGroup().addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(layout.createSequentialGroup().addContainerGap().addComponent(iconLabel).addGap(18, 18, 18).addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(pleaseLabel).addComponent(pathLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 240, javax.swing.GroupLayout.PREFERRED_SIZE))).addGroup(layout.createSequentialGroup().addContainerGap().addComponent(charsetComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 166, javax.swing.GroupLayout.PREFERRED_SIZE).addGap(18, 18, 18).addComponent(autodetectCheckBox, javax.swing.GroupLayout.DEFAULT_SIZE, 169, Short.MAX_VALUE)).addGroup(layout.createSequentialGroup().addGap(76, 76, 76).addComponent(okButton, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(cancelButton, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE).addGap(68, 68, 68))).addContainerGap()));
        layout.setVerticalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(layout.createSequentialGroup().addGap(0, 0, 0).addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING).addGroup(layout.createSequentialGroup().addComponent(pleaseLabel).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(pathLabel)).addComponent(iconLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE)).addGap(16, 16, 16).addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(charsetComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(autodetectCheckBox)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 19, Short.MAX_VALUE).addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(okButton, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(cancelButton, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)).addContainerGap()));
        pack();
    }

    private void formKeyPressed(java.awt.event.KeyEvent evt) {
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            okButton.doClick();
        }
    }

    private void autodetectCheckBoxActionPerformed(java.awt.event.ActionEvent evt) {
        if (autodetectCheckBox.isSelected()) {
            charsetComboBox.setEnabled(false);
        } else {
            charsetComboBox.setEnabled(false);
        }
    }

    private javax.swing.JCheckBox autodetectCheckBox;

    private javax.swing.JButton cancelButton;

    private javax.swing.JComboBox charsetComboBox;

    private javax.swing.JLabel iconLabel;

    private javax.swing.JButton okButton;

    private javax.swing.JLabel pathLabel;

    private javax.swing.JLabel pleaseLabel;

    String value = null;

    String getValue() {
        return value;
    }
}
