package crony.ui.main_frames;

import crony.cronyim.CronyUser;
import javax.swing.ButtonGroup;
import javax.swing.JOptionPane;

/**
 *
 * @author Abhishek
 */
public class CronyRegisterFrame extends javax.swing.JFrame {

    /** Creates new form CronyRegister */
    public CronyRegisterFrame() {
        initComponents();
        setLocationRelativeTo(AppLoginFrame.getInstance());
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        jPanel2 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        firstNameTF = new javax.swing.JTextField();
        lastNameTF = new javax.swing.JTextField();
        createAccountButton = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        usernameTF = new javax.swing.JTextField();
        jButton3 = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        passwordPF = new javax.swing.JPasswordField();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        confirmPasswordPF = new javax.swing.JPasswordField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        maleRB = new javax.swing.JRadioButton();
        femaleRB = new javax.swing.JRadioButton();
        jLabel10 = new javax.swing.JLabel();
        resultLabel = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        emailTF = new javax.swing.JTextField();
        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        jPanel2.setBackground(new java.awt.Color(255, 204, 204));
        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("First Name");
        jLabel2.setText("Last Name");
        createAccountButton.setText("Create Account");
        createAccountButton.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                createAccountButtonActionPerformed(evt);
            }
        });
        jButton2.setText("Cancel");
        jLabel3.setText("Desired User Name");
        jButton3.setText("Check Avaibility");
        jButton3.setEnabled(false);
        jLabel4.setEnabled(false);
        jLabel5.setText("Password");
        jLabel6.setText("Confirm Passoword");
        jLabel7.setText("Fill up the form below to get a local account of Crony with");
        jLabel8.setText("which you can access all your registered accounts at once by");
        jLabel9.setText("just one username and password.");
        maleRB.setBackground(new java.awt.Color(255, 255, 255));
        maleRB.setText("Male");
        maleRB.setActionCommand("MALE");
        sexBGroup.add(maleRB);
        maleRB.setSelected(true);
        femaleRB.setBackground(new java.awt.Color(255, 255, 255));
        femaleRB.setText("Female");
        femaleRB.setActionCommand("FEMALE");
        sexBGroup.add(femaleRB);
        jLabel10.setText("Sex");
        resultLabel.setText("jLabel11");
        jLabel12.setText("Email Address");
        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel1Layout.createSequentialGroup().addContainerGap().addComponent(jLabel7).addContainerGap(39, Short.MAX_VALUE)).addGroup(jPanel1Layout.createSequentialGroup().addContainerGap().addComponent(jLabel8).addContainerGap(22, Short.MAX_VALUE)).addGroup(jPanel1Layout.createSequentialGroup().addContainerGap().addComponent(jLabel9).addContainerGap(152, Short.MAX_VALUE)).addGroup(jPanel1Layout.createSequentialGroup().addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 323, javax.swing.GroupLayout.PREFERRED_SIZE).addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)).addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup().addContainerGap().addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING).addComponent(resultLabel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 300, Short.MAX_VALUE).addGroup(jPanel1Layout.createSequentialGroup().addComponent(createAccountButton).addGap(18, 18, 18).addComponent(jButton2)).addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup().addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jLabel6).addComponent(jLabel5).addComponent(jLabel3).addComponent(jLabel12)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(emailTF, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE).addComponent(confirmPasswordPF, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE).addComponent(passwordPF, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE).addGroup(jPanel1Layout.createSequentialGroup().addComponent(jButton3).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(jLabel4, javax.swing.GroupLayout.DEFAULT_SIZE, 87, Short.MAX_VALUE)).addComponent(usernameTF, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE))).addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel1Layout.createSequentialGroup().addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jLabel2).addComponent(jLabel1).addComponent(jLabel10)).addGap(51, 51, 51).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel1Layout.createSequentialGroup().addComponent(maleRB).addGap(18, 18, 18).addComponent(femaleRB)).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false).addComponent(firstNameTF, javax.swing.GroupLayout.DEFAULT_SIZE, 198, Short.MAX_VALUE).addComponent(lastNameTF))))).addGap(38, 38, 38)));
        jPanel1Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] { createAccountButton, jButton2 });
        jPanel1Layout.setVerticalGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel1Layout.createSequentialGroup().addContainerGap().addComponent(jLabel7).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(jLabel8).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(jLabel9).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(firstNameTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(jLabel1)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(lastNameTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(jLabel2)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(maleRB).addComponent(jLabel10).addComponent(femaleRB)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(usernameTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE).addComponent(jLabel3)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(jButton3).addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 16, javax.swing.GroupLayout.PREFERRED_SIZE)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(jLabel5).addComponent(passwordPF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(jLabel6).addComponent(confirmPasswordPF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(jLabel12).addComponent(emailTF, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)).addGap(18, 18, 18).addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE).addComponent(createAccountButton).addComponent(jButton2)).addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED).addComponent(resultLabel).addContainerGap(35, Short.MAX_VALUE)));
        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel2Layout.createSequentialGroup().addContainerGap().addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 325, javax.swing.GroupLayout.PREFERRED_SIZE).addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)));
        jPanel2Layout.setVerticalGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addGroup(jPanel2Layout.createSequentialGroup().addContainerGap().addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE).addContainerGap()));
        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE));
        layout.setVerticalGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING).addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE));
        pack();
    }

    private void createAccountButtonActionPerformed(java.awt.event.ActionEvent evt) {
        String firstName, lastName, username, password, email;
        firstName = firstNameTF.getText();
        lastName = lastNameTF.getText();
        username = usernameTF.getText();
        password = new String(passwordPF.getPassword());
        email = emailTF.getText();
        if (!validityCheck(firstName, lastName, username, password, email)) return;
        CronyUser cronyUser = new CronyUser(firstName, lastName, sexBGroup.getSelection().getActionCommand(), username, password, email);
        if (cronyUser.registerUser()) {
            JOptionPane.showMessageDialog(this, "You have been successfully " + "registered with Crony. Now you can access Crony with\n" + "your username and password that you have just given", "Account Creation Successful", JOptionPane.INFORMATION_MESSAGE);
            AccountsManagerFrame.getInstance().setVisible(true);
            this.dispose();
        } else {
            JOptionPane.showMessageDialog(this, "Something went wrong in account" + "creation. Please try again with a different username", "Sorry!!", JOptionPane.ERROR_MESSAGE);
        }
    }

    /**
     * Perform validation check on fields of registration form to detect any blank
     * field or malformed data in any field
     * 
     * @param firstName First Name from firstNameTF
     * @param lastName Last Name from lastNameTF
     * @param username Username from usernameTF
     * @param password Password from passwordPF
     * @param email Email address from emailTF
     * @return return true if form passes all validation checks else false
     */
    private boolean validityCheck(String firstName, String lastName, String username, String password, String email) {
        if (firstName.isEmpty()) {
            JOptionPane.showMessageDialog(this, "First name cannot be left blank", "Error", JOptionPane.ERROR_MESSAGE);
            firstNameTF.requestFocusInWindow();
            return false;
        }
        if (lastName.isEmpty()) {
            JOptionPane.showMessageDialog(this, "Last name cannot be left blank", "Error", JOptionPane.ERROR_MESSAGE);
            lastNameTF.requestFocusInWindow();
            return false;
        }
        if (username.isEmpty()) {
            JOptionPane.showMessageDialog(this, "Desired user name cannot be left blank", "Error", JOptionPane.ERROR_MESSAGE);
            usernameTF.requestFocusInWindow();
            return false;
        }
        if (password.isEmpty()) {
            JOptionPane.showMessageDialog(this, "Password cannot be left blank", "Error", JOptionPane.ERROR_MESSAGE);
            passwordPF.requestFocusInWindow();
            return false;
        }
        if (confirmPasswordPF.getPassword().length < 1) {
            JOptionPane.showMessageDialog(this, "You have to re-enter the password", "Error", JOptionPane.ERROR_MESSAGE);
            confirmPasswordPF.requestFocusInWindow();
            return false;
        }
        if (email.isEmpty()) {
            JOptionPane.showMessageDialog(this, "Email field cannot be left blank", "Error", JOptionPane.ERROR_MESSAGE);
            emailTF.requestFocusInWindow();
            return false;
        }
        if (!(new String(confirmPasswordPF.getPassword()).equals(password))) {
            JOptionPane.showMessageDialog(this, "Both passwords does not match, please check again", "Error", JOptionPane.ERROR_MESSAGE);
            confirmPasswordPF.requestFocusInWindow();
            confirmPasswordPF.selectAll();
            return false;
        }
        if (!email.contains("@")) {
            JOptionPane.showMessageDialog(this, "Invalid email address", "Error", JOptionPane.ERROR_MESSAGE);
            emailTF.requestFocusInWindow();
            emailTF.selectAll();
            return false;
        }
        return true;
    }

    public static CronyRegisterFrame getInstance() {
        return cronyRegisterFrame;
    }

    private javax.swing.JPasswordField confirmPasswordPF;

    private javax.swing.JButton createAccountButton;

    private javax.swing.JTextField emailTF;

    private javax.swing.JRadioButton femaleRB;

    private javax.swing.JTextField firstNameTF;

    private javax.swing.JButton jButton2;

    private javax.swing.JButton jButton3;

    private javax.swing.JLabel jLabel1;

    private javax.swing.JLabel jLabel10;

    private javax.swing.JLabel jLabel12;

    private javax.swing.JLabel jLabel2;

    private javax.swing.JLabel jLabel3;

    private javax.swing.JLabel jLabel4;

    private javax.swing.JLabel jLabel5;

    private javax.swing.JLabel jLabel6;

    private javax.swing.JLabel jLabel7;

    private javax.swing.JLabel jLabel8;

    private javax.swing.JLabel jLabel9;

    private javax.swing.JPanel jPanel1;

    private javax.swing.JPanel jPanel2;

    private javax.swing.JSeparator jSeparator1;

    private javax.swing.JTextField lastNameTF;

    private javax.swing.JRadioButton maleRB;

    private javax.swing.JPasswordField passwordPF;

    private javax.swing.JLabel resultLabel;

    private javax.swing.JTextField usernameTF;

    private ButtonGroup sexBGroup = new ButtonGroup();

    private static final CronyRegisterFrame cronyRegisterFrame = new CronyRegisterFrame();
}
