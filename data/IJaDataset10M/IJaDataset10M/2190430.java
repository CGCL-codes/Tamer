package asistenciaOcupacion;

import actividad.ActividadUtil;
import grupo.GrupoParametros;
import grupo.GrupoUtil;
import grupo.GrupoVO;
import instalacion.InstalacionParametros;
import instalacion.InstalacionUtil;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.util.ArrayList;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JRootPane;
import javax.swing.KeyStroke;
import utilidad.Ctes;

public class BuscarAsistenciasOcupacion extends JFrame {

    public BuscarAsistenciasOcupacion() {
        initComponents();
        inicializarForm();
    }

    public BuscarAsistenciasOcupacion(AsistenciaOcupacionParametros parametrosFijos) {
        initComponents();
        this.parametrosFijos = parametrosFijos;
        inicializarForm();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        buttonGroup1 = new javax.swing.ButtonGroup();
        jBBuscar = new javax.swing.JButton();
        jLTitulo = new javax.swing.JLabel();
        jSeparator2 = new javax.swing.JSeparator();
        jCkBGrupo = new javax.swing.JCheckBox();
        jCBGrupo = new utilidad.componentes.MiJComboBox();
        jPFecha = new javax.swing.JPanel();
        jCkBFechaDesde = new javax.swing.JCheckBox();
        jCkBFechaHasta = new javax.swing.JCheckBox();
        jDPFechaDesde = new org.jdesktop.swingx.JXDatePicker();
        jDPFechaHasta = new org.jdesktop.swingx.JXDatePicker();
        jCkBInstalacion = new javax.swing.JCheckBox();
        jCBInstalacion = new utilidad.componentes.MiJComboBox();
        jBSeleccionarGrupo = new javax.swing.JButton();
        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setName("Form");
        setResizable(false);
        getContentPane().setLayout(null);
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("asistenciaOcupacion/Bundle");
        jBBuscar.setText(bundle.getString("BuscarAsistenciasOcupacion.jBBuscar.text"));
        jBBuscar.setName("jBBuscar");
        jBBuscar.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBBuscarActionPerformed(evt);
            }
        });
        getContentPane().add(jBBuscar);
        jBBuscar.setBounds(380, 230, 90, 23);
        jLTitulo.setFont(new java.awt.Font("Arial", 1, 28));
        jLTitulo.setText(bundle.getString("BuscarAsistenciasOcupacion.jLTitulo.text"));
        jLTitulo.setName("jLTitulo");
        getContentPane().add(jLTitulo);
        jLTitulo.setBounds(10, 9, 470, 40);
        jSeparator2.setName("jSeparator2");
        getContentPane().add(jSeparator2);
        jSeparator2.setBounds(0, 60, 490, 10);
        jCkBGrupo.setText(bundle.getString("BuscarAsistenciasOcupacion.jCkBGrupo.text"));
        jCkBGrupo.setName("jCkBGrupo");
        jCkBGrupo.addItemListener(new java.awt.event.ItemListener() {

            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCkBGrupoItemStateChanged(evt);
            }
        });
        getContentPane().add(jCkBGrupo);
        jCkBGrupo.setBounds(10, 110, 100, 23);
        jCBGrupo.setName("jCBGrupo");
        getContentPane().add(jCBGrupo);
        jCBGrupo.setBounds(110, 110, 330, 20);
        jPFecha.setBorder(javax.swing.BorderFactory.createTitledBorder(bundle.getString("BuscarAsistenciasOcupacion.jPFecha.border.title")));
        jPFecha.setName("jPFecha");
        jPFecha.setLayout(null);
        jCkBFechaDesde.setText(bundle.getString("BuscarAsistenciasOcupacion.jCkBFechaDesde.text"));
        jCkBFechaDesde.setName("jCkBFechaDesde");
        jCkBFechaDesde.addItemListener(new java.awt.event.ItemListener() {

            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCkBFechaDesdeItemStateChanged(evt);
            }
        });
        jPFecha.add(jCkBFechaDesde);
        jCkBFechaDesde.setBounds(80, 20, 110, 20);
        jCkBFechaHasta.setText(bundle.getString("BuscarAsistenciasOcupacion.jCkBFechaHasta.text"));
        jCkBFechaHasta.setName("jCkBFechaHasta");
        jCkBFechaHasta.addItemListener(new java.awt.event.ItemListener() {

            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCkBFechaHastaItemStateChanged(evt);
            }
        });
        jPFecha.add(jCkBFechaHasta);
        jCkBFechaHasta.setBounds(80, 50, 110, 23);
        jDPFechaDesde.setFormats("dd/MM/yyyy");
        jDPFechaDesde.setName("jDPFechaDesde");
        jPFecha.add(jDPFechaDesde);
        jDPFechaDesde.setBounds(200, 20, 130, 20);
        jDPFechaHasta.setFormats("dd/MM/yyyy");
        jDPFechaHasta.setName("jDPFechaHasta");
        jPFecha.add(jDPFechaHasta);
        jDPFechaHasta.setBounds(200, 50, 130, 20);
        getContentPane().add(jPFecha);
        jPFecha.setBounds(10, 140, 460, 80);
        jCkBInstalacion.setText(bundle.getString("BuscarAsistenciasOcupacion.jCkBInstalacion.text"));
        jCkBInstalacion.setName("jCkBInstalacion");
        jCkBInstalacion.addItemListener(new java.awt.event.ItemListener() {

            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCkBInstalacionItemStateChanged(evt);
            }
        });
        getContentPane().add(jCkBInstalacion);
        jCkBInstalacion.setBounds(10, 80, 100, 23);
        jCBInstalacion.setName("jCBInstalacion");
        getContentPane().add(jCBInstalacion);
        jCBInstalacion.setBounds(110, 80, 350, 20);
        jBSeleccionarGrupo.setText(bundle.getString("BuscarAsistenciasOcupacion.jBSeleccionarGrupo.text"));
        jBSeleccionarGrupo.setName("jBSeleccionarGrupo");
        jBSeleccionarGrupo.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBSeleccionarGrupoActionPerformed(evt);
            }
        });
        getContentPane().add(jBSeleccionarGrupo);
        jBSeleccionarGrupo.setBounds(440, 110, 20, 20);
        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width - 493) / 2, (screenSize.height - 301) / 2, 493, 301);
    }

    private void jBBuscarActionPerformed(java.awt.event.ActionEvent evt) {
        buscar();
    }

    private void jCkBFechaDesdeItemStateChanged(java.awt.event.ItemEvent evt) {
        ajustarVisibilidades();
    }

    private void jCkBFechaHastaItemStateChanged(java.awt.event.ItemEvent evt) {
        ajustarVisibilidades();
    }

    private void jCkBGrupoItemStateChanged(java.awt.event.ItemEvent evt) {
        ajustarVisibilidades();
    }

    private void jCkBInstalacionItemStateChanged(java.awt.event.ItemEvent evt) {
        ajustarVisibilidades();
    }

    private void jBSeleccionarGrupoActionPerformed(java.awt.event.ActionEvent evt) {
        seleccionarGrupo();
    }

    public void inicializarForm() {
        ajustarVisibilidades();
        cargarCombos();
        fijarParametros();
    }

    private void ajustarVisibilidades() {
        jCBInstalacion.setVisible(jCkBInstalacion.isSelected());
        jCBGrupo.setVisible(jCkBGrupo.isSelected());
        jBSeleccionarGrupo.setVisible(jCkBGrupo.isSelected());
        jDPFechaDesde.setVisible(jCkBFechaDesde.isSelected());
        jDPFechaHasta.setVisible(jCkBFechaHasta.isSelected());
    }

    private void cargarCombos() {
        cargarComboInstalaciones();
        cargarComboGrupos();
    }

    private void cargarComboGrupos() {
        GrupoParametros param = new GrupoParametros();
        ArrayList lista = GrupoUtil.listado(param);
        jCBGrupo.cargarLista(lista, "grupo.GrupoVO", "getDatos");
        if (lista.size() > 0) jCBGrupo.setSelectedIndex(0);
    }

    private void cargarComboInstalaciones() {
        InstalacionParametros param = new InstalacionParametros();
        ArrayList lista = InstalacionUtil.listado(param);
        jCBInstalacion.cargarLista(lista, "instalacion.InstalacionVO", "getNombre");
        if (lista.size() > 0) jCBInstalacion.setSelectedIndex(0);
    }

    private void seleccionarGrupo() {
        GrupoParametros param = new GrupoParametros();
        param.estado1Actividad = ActividadUtil.ESTADO_PTE_INICIO;
        param.estado2Actividad = ActividadUtil.ESTADO_EN_CURSO;
        GrupoVO grupoSel = GrupoUtil.seleccionarGrupo(this, (GrupoVO) this.jCBGrupo.getSelectedObj(), param, null);
        if (grupoSel != null) {
            cargarComboGrupos();
            jCBGrupo.a√±adirVO(grupoSel, "grupo.GrupoVO", "getDatos");
            jCBGrupo.setSelectedId(grupoSel.getId());
        }
    }

    private void fijarParametros() {
        if (parametrosFijos != null) {
            if (parametrosFijos.idInstalacion != null) {
                jCkBInstalacion.setSelected(true);
                jCkBInstalacion.setEnabled(false);
                jCBInstalacion.setSelectedId(parametrosFijos.idInstalacion);
                jCBInstalacion.setEnabled(false);
            }
            if (parametrosFijos.idGrupo != null) {
                jCkBGrupo.setSelected(true);
                jCkBGrupo.setEnabled(false);
                jCBGrupo.setSelectedId(parametrosFijos.idGrupo);
                jCBGrupo.setEnabled(false);
            }
        }
    }

    private void buscar() {
        this.parametroSel = new AsistenciaOcupacionParametros();
        if (jCkBInstalacion.isSelected()) {
            this.parametroSel.idInstalacion = jCBInstalacion.getSelectedId();
        }
        if (jCkBGrupo.isSelected()) {
            this.parametroSel.idGrupo = jCBGrupo.getSelectedId();
        }
        if (jCkBFechaDesde.isSelected()) {
            this.parametroSel.fechaDesde = jDPFechaDesde.getDate();
        }
        if (jCkBFechaHasta.isSelected()) {
            this.parametroSel.fechaHasta = jDPFechaHasta.getDate();
        }
        dispose();
    }

    public AsistenciaOcupacionParametros parametroSel = null;

    public AsistenciaOcupacionParametros parametrosFijos = null;

    @Override
    protected JRootPane createRootPane() {
        JRootPane rootPane = new JRootPane();
        Action actionEscape = new AbstractAction() {

            public void actionPerformed(ActionEvent actionEvent) {
                dispose();
            }
        };
        Action actionEnter = new AbstractAction() {

            public void actionPerformed(ActionEvent actionEvent) {
                buscar();
            }
        };
        KeyStroke strokeEscape = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0);
        KeyStroke strokeEnter = KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0);
        rootPane.registerKeyboardAction(actionEscape, strokeEscape, JComponent.WHEN_IN_FOCUSED_WINDOW);
        rootPane.registerKeyboardAction(actionEnter, strokeEnter, JComponent.WHEN_IN_FOCUSED_WINDOW);
        return rootPane;
    }

    private javax.swing.ButtonGroup buttonGroup1;

    private javax.swing.JButton jBBuscar;

    private javax.swing.JButton jBSeleccionarGrupo;

    private utilidad.componentes.MiJComboBox jCBGrupo;

    private utilidad.componentes.MiJComboBox jCBInstalacion;

    private javax.swing.JCheckBox jCkBFechaDesde;

    private javax.swing.JCheckBox jCkBFechaHasta;

    private javax.swing.JCheckBox jCkBGrupo;

    private javax.swing.JCheckBox jCkBInstalacion;

    private org.jdesktop.swingx.JXDatePicker jDPFechaDesde;

    private org.jdesktop.swingx.JXDatePicker jDPFechaHasta;

    private javax.swing.JLabel jLTitulo;

    private javax.swing.JPanel jPFecha;

    private javax.swing.JSeparator jSeparator2;
}
