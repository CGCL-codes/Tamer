package horario;

import java.awt.Cursor;
import java.util.*;
import utilidad.*;

public class GenerarHoras extends javax.swing.JFrame {

    public GenerarHoras(HorarioParametros param) {
        initComponents();
        this.parametrosFijos = param;
        inicializarForm();
    }

    public GenerarHoras(HorarioParametros param, Date horaInicio, Date horaFin) {
        initComponents();
        this.parametrosFijos = param;
        this.horaInicio = horaInicio;
        this.horaFin = horaFin;
        inicializarForm();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private void initComponents() {
        buttonGroup1 = new javax.swing.ButtonGroup();
        jLTitulo = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        jLError = new javax.swing.JLabel();
        jTPDatos = new javax.swing.JTabbedPane();
        jPDatos = new javax.swing.JPanel();
        jLInstalacion = new javax.swing.JLabel();
        jTFInstalacion = new utilidad.componentes.MiJTFTexto();
        jLHoraFin = new javax.swing.JLabel();
        jLHoraInicio = new javax.swing.JLabel();
        jSHoraFin = new javax.swing.JSpinner();
        jSHoraInicio = new javax.swing.JSpinner();
        jDPFecha = new org.jdesktop.swingx.JXDatePicker();
        jLFecha = new javax.swing.JLabel();
        jTFMinutos = new utilidad.componentes.MiJFTFDecimal();
        jLIntervaloMinutos = new javax.swing.JLabel();
        jBGenerar = new javax.swing.JButton();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMConfiguracion = new javax.swing.JMenu();
        jMICreacionModificacion = new javax.swing.JMenuItem();
        jMAyuda = new javax.swing.JMenu();
        jMIPaginaInicio = new javax.swing.JMenuItem();
        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setName("Form");
        setResizable(false);
        addWindowListener(new java.awt.event.WindowAdapter() {

            public void windowClosed(java.awt.event.WindowEvent evt) {
                formWindowClosed(evt);
            }
        });
        getContentPane().setLayout(null);
        jLTitulo.setFont(new java.awt.Font("Arial", 1, 24));
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("horario/Bundle");
        jLTitulo.setText(bundle.getString("GenerarHoras.jLTitulo.text"));
        jLTitulo.setToolTipText(bundle.getString("GenerarHoras.jLTitulo.toolTipText"));
        jLTitulo.setName("jLTitulo");
        getContentPane().add(jLTitulo);
        jLTitulo.setBounds(10, 10, 480, 29);
        jSeparator1.setName("jSeparator1");
        getContentPane().add(jSeparator1);
        jSeparator1.setBounds(0, 50, 660, 10);
        jLError.setFont(new java.awt.Font("Arial", 1, 11));
        jLError.setForeground(java.awt.Color.red);
        jLError.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLError.setText(bundle.getString("GenerarHoras.jLError.text"));
        jLError.setName("jLError");
        jLError.setText("");
        getContentPane().add(jLError);
        jLError.setBounds(10, 280, 450, 20);
        jTPDatos.setToolTipText(bundle.getString("GenerarHoras.jTPDatos.toolTipText"));
        jTPDatos.setFont(new java.awt.Font("Arial", 0, 11));
        jTPDatos.setName("jTPDatos");
        jPDatos.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPDatos.setToolTipText(bundle.getString("GenerarHoras.jPDatos.toolTipText"));
        jPDatos.setName("jPDatos");
        jPDatos.setLayout(null);
        jLInstalacion.setText(bundle.getString("GenerarHoras.jLInstalacion.text"));
        jLInstalacion.setName("jLInstalacion");
        jPDatos.add(jLInstalacion);
        jLInstalacion.setBounds(10, 10, 80, 14);
        jTFInstalacion.setEditable(false);
        jTFInstalacion.setName("jTFInstalacion");
        jPDatos.add(jTFInstalacion);
        jTFInstalacion.setBounds(10, 30, 390, 20);
        jLHoraFin.setText(bundle.getString("GenerarHoras.jLHoraFin.text"));
        jLHoraFin.setName("jLHoraFin");
        jPDatos.add(jLHoraFin);
        jLHoraFin.setBounds(100, 60, 80, 20);
        jLHoraInicio.setText(bundle.getString("GenerarHoras.jLHoraInicio.text"));
        jLHoraInicio.setName("jLHoraInicio");
        jPDatos.add(jLHoraInicio);
        jLHoraInicio.setBounds(10, 60, 80, 20);
        jSHoraFin.setModel(new javax.swing.SpinnerDateModel());
        jSHoraFin.setEditor(new javax.swing.JSpinner.DateEditor(jSHoraFin, "H:mm"));
        jSHoraFin.setName("jSHoraFin");
        jPDatos.add(jSHoraFin);
        jSHoraFin.setBounds(90, 80, 60, 20);
        jSHoraInicio.setModel(new javax.swing.SpinnerDateModel());
        jSHoraInicio.setEditor(new javax.swing.JSpinner.DateEditor(jSHoraInicio, "H:mm"));
        jSHoraInicio.setName("jSHoraInicio");
        jPDatos.add(jSHoraInicio);
        jSHoraInicio.setBounds(10, 80, 60, 20);
        jDPFecha.setFormats("dd/MM/yyyy");
        jDPFecha.setName("jDPFecha");
        jPDatos.add(jDPFecha);
        jDPFecha.setBounds(300, 80, 100, 20);
        jLFecha.setText(bundle.getString("GenerarHoras.jLFecha.text"));
        jLFecha.setName("jLFecha");
        jPDatos.add(jLFecha);
        jLFecha.setBounds(300, 60, 80, 20);
        jTFMinutos.setName("jTFMinutos");
        jPDatos.add(jTFMinutos);
        jTFMinutos.setBounds(200, 80, 70, 20);
        jLIntervaloMinutos.setText(bundle.getString("GenerarHoras.jLIntervaloMinutos.text"));
        jLIntervaloMinutos.setName("jLIntervaloMinutos");
        jPDatos.add(jLIntervaloMinutos);
        jLIntervaloMinutos.setBounds(200, 60, 100, 14);
        jTPDatos.addTab(bundle.getString("GenerarHoras.jPDatos.TabConstraints.tabTitle"), jPDatos);
        getContentPane().add(jTPDatos);
        jTPDatos.setBounds(20, 70, 430, 170);
        java.util.ResourceBundle bundle1 = java.util.ResourceBundle.getBundle("cliente/Bundle");
        jTPDatos.getAccessibleContext().setAccessibleName(bundle1.getString("DatosCliente.jTPDatos.AccessibleContext.accessibleName"));
        jBGenerar.setText(bundle.getString("GenerarHoras.jBGenerar.text"));
        jBGenerar.setName("jBGenerar");
        jBGenerar.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBGenerarActionPerformed(evt);
            }
        });
        getContentPane().add(jBGenerar);
        jBGenerar.setBounds(350, 250, 100, 23);
        jMenuBar1.setName("jMenuBar1");
        jMConfiguracion.setText(bundle.getString("GenerarHoras.jMConfiguracion.text"));
        jMConfiguracion.setName("jMConfiguracion");
        jMICreacionModificacion.setText(bundle.getString("GenerarHoras.jMICreacionModificacion.text"));
        jMICreacionModificacion.setName("jMICreacionModificacion");
        jMICreacionModificacion.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMICreacionModificacionActionPerformed(evt);
            }
        });
        jMConfiguracion.add(jMICreacionModificacion);
        jMenuBar1.add(jMConfiguracion);
        jMAyuda.setText(bundle.getString("GenerarHoras.jMAyuda.text"));
        jMAyuda.setName("jMAyuda");
        jMIPaginaInicio.setText(bundle.getString("GenerarHoras.jMIPaginaInicio.text"));
        jMIPaginaInicio.setName("jMIPaginaInicio");
        jMIPaginaInicio.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMIPaginaInicioActionPerformed(evt);
            }
        });
        jMAyuda.add(jMIPaginaInicio);
        jMenuBar1.add(jMAyuda);
        setJMenuBar(jMenuBar1);
        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width - 476) / 2, (screenSize.height - 361) / 2, 476, 361);
    }

    private void jBGenerarActionPerformed(java.awt.event.ActionEvent evt) {
        generarHorarios();
    }

    private void jMICreacionModificacionActionPerformed(java.awt.event.ActionEvent evt) {
        verCreacionModificacion();
    }

    private void jMIPaginaInicioActionPerformed(java.awt.event.ActionEvent evt) {
        irPaginaInicio();
    }

    private void formWindowClosed(java.awt.event.WindowEvent evt) {
        Util.eliminarReferenciaLista(this);
    }

    private void cancelar() {
        this.dispose();
    }

    private void irPaginaInicio() {
        inicio.InicioApp.cerrarVentanasAbiertas();
        this.dispose();
    }

    private void verCreacionModificacion() {
    }

    private void inicializarForm() {
        Util.cambiarIcono(this);
        ajustarVisibilidades();
        this.setTitle(java.util.ResourceBundle.getBundle("horario/Bundle").getString("Generar_Horarios_de_Reserva_"));
        jLTitulo.setText(java.util.ResourceBundle.getBundle("horario/Bundle").getString("Generar_Horarios_de_Reserva_"));
        mostrarObjeto();
    }

    private void ajustarVisibilidades() {
        jLFecha.setVisible(false);
        jDPFecha.setVisible(false);
    }

    private void mostrarObjeto() {
        jTFInstalacion.setText(parametrosFijos.datosEntidad);
        jDPFecha.setDate(Util.getFechaBD());
        jSHoraInicio.setValue(horaInicio);
        jSHoraFin.setValue(horaFin);
        jTFMinutos.setValue(60F);
    }

    private void validarObjeto() throws MiExcepcion {
    }

    private void generarHorarios() {
        this.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
        Date fecha = jDPFecha.getDate();
        Date horaInicio = (Date) jSHoraInicio.getValue();
        Date horaFin = (Date) jSHoraFin.getValue();
        int minutos = jTFMinutos.getValue().intValue();
        Calendar calHoraInicio = Calendar.getInstance();
        calHoraInicio.setTime(Util.crearFecha(fecha, horaInicio));
        Calendar calHoraFin = Calendar.getInstance();
        calHoraFin.setTime(Util.crearFecha(fecha, horaFin));
        if (calHoraInicio.compareTo(calHoraFin) > 0) {
            calHoraFin.add(Calendar.DATE, 1);
        }
        while (calHoraInicio.compareTo(calHoraFin) < 0) {
            HorarioVO horario = new HorarioVO();
            horario.setEntidad(parametrosFijos.entidad);
            horario.setIdEntidad(parametrosFijos.idEntidad);
            horario.setFechaInicio(fecha);
            horario.setFechaFin(fecha);
            horario.setHoraInicio(calHoraInicio.getTime());
            calHoraInicio.add(Calendar.MINUTE, minutos);
            horario.setHoraFin(calHoraInicio.getTime());
            HorarioUtil.insertar(horario);
        }
        this.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
        this.dispose();
    }

    private HorarioParametros parametrosFijos = new HorarioParametros();

    private Date horaInicio = Util.getFechaBD();

    private Date horaFin = Util.getFechaBD();

    private javax.swing.ButtonGroup buttonGroup1;

    private javax.swing.JButton jBGenerar;

    private org.jdesktop.swingx.JXDatePicker jDPFecha;

    private javax.swing.JLabel jLError;

    private javax.swing.JLabel jLFecha;

    private javax.swing.JLabel jLHoraFin;

    private javax.swing.JLabel jLHoraInicio;

    private javax.swing.JLabel jLInstalacion;

    private javax.swing.JLabel jLIntervaloMinutos;

    private javax.swing.JLabel jLTitulo;

    private javax.swing.JMenu jMAyuda;

    private javax.swing.JMenu jMConfiguracion;

    private javax.swing.JMenuItem jMICreacionModificacion;

    private javax.swing.JMenuItem jMIPaginaInicio;

    private javax.swing.JMenuBar jMenuBar1;

    private javax.swing.JPanel jPDatos;

    private javax.swing.JSpinner jSHoraFin;

    private javax.swing.JSpinner jSHoraInicio;

    private javax.swing.JSeparator jSeparator1;

    private utilidad.componentes.MiJTFTexto jTFInstalacion;

    private utilidad.componentes.MiJFTFDecimal jTFMinutos;

    private javax.swing.JTabbedPane jTPDatos;
}
