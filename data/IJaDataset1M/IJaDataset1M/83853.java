package schemacrawler.crawl;

import java.util.Collections;
import java.util.HashMap;
import java.util.Map;
import schemacrawler.Version;
import schemacrawler.schema.SchemaCrawlerInfo;
import schemacrawler.schemacrawler.Config;

/**
 * SchemaCrawler information.
 * 
 * @author Sualeh Fatehi sualeh@hotmail.com
 */
final class MutableSchemaCrawlerInfo implements SchemaCrawlerInfo {

    private static final long serialVersionUID = 4051323422934251828L;

    private static final String NEWLINE = System.getProperty("line.separator");

    private String schemaCrawlerProductName;

    private String schemaCrawlerVersion;

    private String schemaCrawlerAbout;

    /**
   * Needs to be sorted, so serialization does not break.
   */
    private final Map<String, String> systemProperties = new HashMap<String, String>();

    @Override
    public String getSchemaCrawlerAbout() {
        return schemaCrawlerAbout;
    }

    @Override
    public String getSchemaCrawlerProductName() {
        return schemaCrawlerProductName;
    }

    @Override
    public String getSchemaCrawlerVersion() {
        return schemaCrawlerVersion;
    }

    /**
   * {@inheritDoc}
   * 
   * @see schemacrawler.schema.SchemaCrawlerInfo#getSystemProperties()
   */
    @Override
    public Map<String, String> getSystemProperties() {
        return Collections.unmodifiableMap(systemProperties);
    }

    /**
   * {@inheritDoc}
   * 
   * @see Object#toString()
   */
    @Override
    public String toString() {
        final StringBuilder info = new StringBuilder();
        info.append("-- generated by: ").append(getSchemaCrawlerProductName()).append(' ').append(getSchemaCrawlerVersion()).append(NEWLINE);
        return info.toString();
    }

    void setAdditionalSchemaCrawlerInfo() {
        systemProperties.putAll(new Config(System.getProperties()));
    }

    void setSchemaCrawlerInfo() {
        schemaCrawlerProductName = Version.getProductName();
        schemaCrawlerVersion = Version.getVersion();
        schemaCrawlerAbout = Version.about();
    }
}
