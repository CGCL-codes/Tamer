    public void testForward() throws IOException {
        System.out.println("\nforward");
        SimpleBufferTransformer bufferTransformer = new SimpleBufferTransformer();
        MyTransformer myTransformer = new MyTransformer();
        bufferTransformer.setNextTransformer(myTransformer);
        System.out.println("one input - one forward");
        ByteBuffer input = createRandomBuffer(100);
        int size = input.remaining();
        bufferTransformer.transform(input);
        ByteBuffer result = myTransformer.getInput();
        assertNull(result);
        bufferTransformer.forward(size);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(size, result.remaining());
        System.out.println("one input - two forwards");
        input = createRandomBuffer(100);
        size = input.remaining();
        bufferTransformer.transform(input);
        result = myTransformer.getInput();
        int firstHalf = random.nextInt(size + 1);
        bufferTransformer.forward(firstHalf);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(firstHalf, result.remaining());
        int secondHalf = size - firstHalf;
        bufferTransformer.forward(secondHalf);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(secondHalf, result.remaining());
        System.out.println("two inputs - one forward");
        input = createRandomBuffer(100);
        size = input.remaining();
        bufferTransformer.transform(input);
        input = createRandomBuffer(100);
        size += input.remaining();
        bufferTransformer.transform(input);
        bufferTransformer.forward(size);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(size, result.remaining());
        System.out.println("two inputs - two forwards");
        input = createRandomBuffer(100);
        size = input.remaining();
        bufferTransformer.transform(input);
        input = createRandomBuffer(100);
        size += input.remaining();
        bufferTransformer.transform(input);
        firstHalf = random.nextInt(size + 1);
        bufferTransformer.forward(firstHalf);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(firstHalf, result.remaining());
        secondHalf = size - firstHalf;
        bufferTransformer.forward(secondHalf);
        result = myTransformer.getInput();
        assertNotNull(result);
        assertEquals(secondHalf, result.remaining());
    }
