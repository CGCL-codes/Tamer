    public void testForward() throws IOException {
        System.out.println("\nforward");
        BufferForwarder bufferTransformer = new BufferForwarder(ByteBufferForwardingMode.DIRECT);
        byteBufferToArrayTransformer.setNextForwarder(bufferTransformer);
        MyByteBufferCopyForwarder myByteBufferCopyForwarder = new MyByteBufferCopyForwarder();
        bufferTransformer.setNextForwarder(myByteBufferCopyForwarder);
        System.out.println("one input - one forward");
        ByteBuffer input = createRandomBuffer(100);
        int size = input.remaining();
        byteBufferToArrayTransformer.forward(input);
        ByteBuffer result = myByteBufferCopyForwarder.getInput();
        assertNull(result);
        bufferTransformer.forward(size);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(size, result.remaining());
        System.out.println("one input - two forwards");
        input = createRandomBuffer(100);
        size = input.remaining();
        byteBufferToArrayTransformer.forward(input);
        result = myByteBufferCopyForwarder.getInput();
        int firstHalf = random.nextInt(size + 1);
        bufferTransformer.forward(firstHalf);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(firstHalf, result.remaining());
        int secondHalf = size - firstHalf;
        bufferTransformer.forward(secondHalf);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(secondHalf, result.remaining());
        System.out.println("two inputs - one forward");
        input = createRandomBuffer(100);
        size = input.remaining();
        byteBufferToArrayTransformer.forward(input);
        input = createRandomBuffer(100);
        size += input.remaining();
        byteBufferToArrayTransformer.forward(input);
        bufferTransformer.forward(size);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(size, result.remaining());
        System.out.println("two inputs - two forwards");
        input = createRandomBuffer(100);
        size = input.remaining();
        byteBufferToArrayTransformer.forward(input);
        input = createRandomBuffer(100);
        size += input.remaining();
        byteBufferToArrayTransformer.forward(input);
        firstHalf = random.nextInt(size + 1);
        bufferTransformer.forward(firstHalf);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(firstHalf, result.remaining());
        secondHalf = size - firstHalf;
        bufferTransformer.forward(secondHalf);
        result = myByteBufferCopyForwarder.getInput();
        assertNotNull(result);
        assertEquals(secondHalf, result.remaining());
    }
