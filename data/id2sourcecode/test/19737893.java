    protected void writeHeader() throws IOException, UnsupportedOperationException {
        this.out.println("<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">");
        this.out.println("<HTML>");
        this.out.println("<HEAD>");
        this.out.println("<!-- generated by " + getClass().getName() + " -->");
        this.out.println("<meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\">");
        this.out.println("<TITLE>" + this.title + "</TITLE>");
        for (int css = 0; css < this.stylesheets.length; css++) {
            if (this.embedStyleSheet) {
                try {
                    this.out.println("<STYLE TYPE=\"text/css\">");
                    InputStream in = this.stylesheets[css].openStream();
                    for (int read = in.read(); read != -1; read = in.read()) this.out.write(read);
                    this.out.println("</STYLE>");
                } catch (IOException ioe) {
                    this.out.println("<!--");
                    ioe.printStackTrace(out);
                    this.out.println("-->");
                }
            } else this.out.println("<LINK REL=\"stylesheet\" TYPE=\"text/css\" HREF=\"" + this.stylesheets[css] + "\" charset=\"UTF-8\"/>");
        }
        this.out.println("</HEAD>");
        this.out.println("<BODY>");
        this.out.println("<TABLE>");
        if (this.includeTableHeader) this.out.println("<TR class=\"header\"><TH class=\"date\">DATE</TH><TH class=\"channel\">CHANNEL</TH><TH class=\"source\">SOURCE</TH><TH class=\"message\">MESSAGE</TH></TR>");
    }
