    public Collection<Content> getContent() throws RepositoryException {
        Element script = new Element("script", xhtml).setAttribute("type", "text/javascript").addContent("function submitProject() {\n" + ((project == null) ? "  var url = '" + context.getAppURL(parent.getPath()) + "';\n" : "  var url = '" + context.getAppURL(project.getPath()) + "';\n") + "  var parameters = serializeHash('#project-form');\n" + (project == null || context.getAccessPolicy().canUpdateProjectAccessRights(project.getPath()) ? "  parameters['manager-users'] = allOptions('#project-form-manager-users-field');\n" + "  parameters['writer-users'] =  allOptions('#project-form-writer-users-field');\n" + "  parameters['reader-users'] =  allOptions('#project-form-reader-users-field');\n" + "  parameters['manager-groups'] = allOptions('#project-form-manager-groups-field');\n" + "  parameters['writer-groups'] =  allOptions('#project-form-writer-groups-field');\n" + "  parameters['reader-groups'] =  allOptions('#project-form-reader-groups-field');\n" : "") + "  jQuery.ajax({\n" + "    url: url,\n" + "    type: 'POST',\n" + "    beforeSend: function(xhr) {\n" + ((project == null) ? "      xhr.setRequestHeader('Slug', jQuery('#project-form-name-field').val());\n" : "      xhr.setRequestHeader('X-HTTP-Method-Override', 'PUT');\n") + "    },\n" + "    data: parameters,\n" + "    error: function(xhr, textStatus, errorThrown) {\n" + "      displayErrors(xhr, '#project-form-errors');\n" + "    },\n" + "    complete: function (xhr, textStatus) {\n" + "      if (textStatus == 'success') {\n" + ((project == null) ? "        window.location = xhr.getResponseHeader('Location');\n" : "        window.location = url;\n") + "      }\n" + "    }\n" + "  });\n" + "}\n");
        Element form = new Element("form", xhtml).setAttribute("id", "project-form").setAttribute("onsubmit", "submitProject(); return false;");
        Element table = new Element("table", xhtml);
        table.addContent(new Element("tr", xhtml).addContent(new Element("td", xhtml).setAttribute("class", "label").addContent(buildLabel("project", "title", "Title", true))).addContent(new Element("td", xhtml).setAttribute("class", "field").addContent(buildTextInput("project", "title", 60, project, "title"))));
        table.addContent(new Element("tr", xhtml).addContent(new Element("td", xhtml).setAttribute("class", "label").addContent(buildLabel("project", "description", "Description", false))).addContent(new Element("td", xhtml).setAttribute("class", "field").addContent(buildTextArea("project", "description", 10, 58, project, "description"))));
        if (project == null || context.getAccessPolicy().canUpdateProjectAccessRights(project.getPath())) {
            List<Node> allUsers = NodeUtils.getList(UserUtils.getAllUsers(parent.getSession()));
            List<Node> allGroups = NodeUtils.getList(GroupUtils.getAllGroups(parent.getSession()));
            table.addContent(buildAccessRightsRow(project, allUsers, allGroups, context.getUser()));
        }
        if (project == null) {
            table.addContent(new Element("tr", xhtml).addContent(new Element("td", xhtml).setAttribute("class", "label").addContent(buildLabel("project", "name", "Handle", true))).addContent(new Element("td", xhtml).setAttribute("class", "field").addContent(buildTextInput("project", "name", 15, HandleUtils.generateString(context.getSession(), context.getAppPath(parent.getPath())))).addContent(new Element("p", xhtml).setAttribute("class", "description").addContent("The handle is a short tag that determines the URL assigned to the project.").addContent(new Element("br", xhtml)).addContent("For example, entering \"sg2009\" will create a project at ").addContent(new Element("tt", xhtml).setText(context.getAppPath(parent.getPath() + "/sg2009"))).addContent("."))));
        }
        form.addContent(new Element("fieldset", xhtml).addContent(new Element("legend", xhtml).setText("Project details")).addContent(table));
        form.addContent(new Element("div", xhtml).setAttribute("id", "project-form-errors").addContent(new Comment("hack to prevent tag minimisation")));
        form.addContent(new Element("div", xhtml).setAttribute("class", "buttonset").addContent(new Element("input", xhtml).setAttribute("type", "submit").setAttribute("value", "Save")));
        return Arrays.asList((Content) script, (Content) form);
    }
